/*! mobile-text-selection 0.2.0*/
var t="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},e=function(t){return t&&t.Math==Math&&t},n=e("object"==typeof globalThis&&globalThis)||e("object"==typeof window&&window)||e("object"==typeof self&&self)||e("object"==typeof t&&t)||Function("return this")(),r={},o=function(t){try{return!!t()}catch(t){return!0}},i=!o((function(){return 7!=Object.defineProperty({},1,{get:function(){return 7}})[1]})),c={},a={}.propertyIsEnumerable,s=Object.getOwnPropertyDescriptor,l=s&&!a.call({1:2},1);c.f=l?function(t){var e=s(this,t);return!!e&&e.enumerable}:a;var u=function(t,e){return{enumerable:!(1&t),configurable:!(2&t),writable:!(4&t),value:e}},f={}.toString,d=function(t){return f.call(t).slice(8,-1)},h=d,p="".split,y=o((function(){return!Object("z").propertyIsEnumerable(0)}))?function(t){return"String"==h(t)?p.call(t,""):Object(t)}:Object,v=function(t){if(null==t)throw TypeError("Can't call method on "+t);return t},g=y,m=v,x=function(t){return g(m(t))},b=function(t){return"object"==typeof t?null!==t:"function"==typeof t},S=b,w=function(t,e){if(!S(t))return t;var n,r;if(e&&"function"==typeof(n=t.toString)&&!S(r=n.call(t)))return r;if("function"==typeof(n=t.valueOf)&&!S(r=n.call(t)))return r;if(!e&&"function"==typeof(n=t.toString)&&!S(r=n.call(t)))return r;throw TypeError("Can't convert object to primitive value")},O={}.hasOwnProperty,C=function(t,e){return O.call(t,e)},T=b,E=n.document,A=T(E)&&T(E.createElement),R=function(t){return A?E.createElement(t):{}},k=R,N=!i&&!o((function(){return 7!=Object.defineProperty(k("div"),"a",{get:function(){return 7}}).a})),P=i,j=c,L=u,M=x,I=w,_=C,D=N,F=Object.getOwnPropertyDescriptor;r.f=P?F:function(t,e){if(t=M(t),e=I(e,!0),D)try{return F(t,e)}catch(t){}if(_(t,e))return L(!j.f.call(t,e),t[e])};var z=o,B=/#|\.prototype\./,W=function(t,e){var n=H[G(t)];return n==Y||n!=K&&("function"==typeof e?z(e):!!e)},G=W.normalize=function(t){return String(t).replace(B,".").toLowerCase()},H=W.data={},K=W.NATIVE="N",Y=W.POLYFILL="P",U=W,V={},X=function(t){if("function"!=typeof t)throw TypeError(String(t)+" is not a function");return t},$=function(t,e,n){if(X(t),void 0===e)return t;switch(n){case 0:return function(){return t.call(e)};case 1:return function(n){return t.call(e,n)};case 2:return function(n,r){return t.call(e,n,r)};case 3:return function(n,r,o){return t.call(e,n,r,o)}}return function(){return t.apply(e,arguments)}},J={},q=b,Q=function(t){if(!q(t))throw TypeError(String(t)+" is not an object");return t},Z=i,tt=N,et=Q,nt=w,rt=Object.defineProperty;J.f=Z?rt:function(t,e,n){if(et(t),e=nt(e,!0),et(n),tt)try{return rt(t,e,n)}catch(t){}if("get"in n||"set"in n)throw TypeError("Accessors not supported");return"value"in n&&(t[e]=n.value),t};var ot=J,it=u,ct=i?function(t,e,n){return ot.f(t,e,it(1,n))}:function(t,e,n){return t[e]=n,t},at=n,st=r.f,lt=U,ut=V,ft=$,dt=ct,ht=C,pt=function(t){var e=function(e,n,r){if(this instanceof t){switch(arguments.length){case 0:return new t;case 1:return new t(e);case 2:return new t(e,n)}return new t(e,n,r)}return t.apply(this,arguments)};return e.prototype=t.prototype,e},yt=function(t,e){var n,r,o,i,c,a,s,l,u=t.target,f=t.global,d=t.stat,h=t.proto,p=f?at:d?at[u]:(at[u]||{}).prototype,y=f?ut:ut[u]||(ut[u]={}),v=y.prototype;for(o in e)n=!lt(f?o:u+(d?".":"#")+o,t.forced)&&p&&ht(p,o),c=y[o],n&&(a=t.noTargetGet?(l=st(p,o))&&l.value:p[o]),i=n&&a?a:e[o],n&&typeof c==typeof i||(s=t.bind&&n?ft(i,at):t.wrap&&n?pt(i):h&&"function"==typeof i?ft(Function.call,i):i,(t.sham||i&&i.sham||c&&c.sham)&&dt(s,"sham",!0),y[o]=s,h&&(ht(ut,r=u+"Prototype")||dt(ut,r,{}),ut[r][o]=i,t.real&&v&&!v[o]&&dt(v,o,i)))},vt=d,gt=Array.isArray||function(t){return"Array"==vt(t)};yt({target:"Array",stat:!0},{isArray:gt});var mt=V.Array.isArray,xt=mt,bt=xt;var St=function(t){if(bt(t))return t},wt={},Ot=n,Ct=ct,Tt=function(t,e){try{Ct(Ot,t,e)}catch(n){Ot[t]=e}return e},Et=n["__core-js_shared__"]||Tt("__core-js_shared__",{}),At=Et,Rt=Function.toString;"function"!=typeof At.inspectSource&&(At.inspectSource=function(t){return Rt.call(t)});var kt=At.inspectSource,Nt=n.WeakMap,Pt="function"==typeof Nt&&/native code/.test(kt(Nt)),jt={exports:{}},Lt=Et;(jt.exports=function(t,e){return Lt[t]||(Lt[t]=void 0!==e?e:{})})("versions",[]).push({version:"3.6.4",mode:"pure",copyright:"© 2020 Denis Pushkarev (zloirock.ru)"});var Mt,It,_t,Dt=0,Ft=Math.random(),zt=function(t){return"Symbol("+String(void 0===t?"":t)+")_"+(++Dt+Ft).toString(36)},Bt=jt.exports,Wt=zt,Gt=Bt("keys"),Ht=function(t){return Gt[t]||(Gt[t]=Wt(t))},Kt={},Yt=Pt,Ut=b,Vt=ct,Xt=C,$t=Ht,Jt=Kt,qt=n.WeakMap;if(Yt){var Qt=new qt,Zt=Qt.get,te=Qt.has,ee=Qt.set;Mt=function(t,e){return ee.call(Qt,t,e),e},It=function(t){return Zt.call(Qt,t)||{}},_t=function(t){return te.call(Qt,t)}}else{var ne=$t("state");Jt[ne]=!0,Mt=function(t,e){return Vt(t,ne,e),e},It=function(t){return Xt(t,ne)?t[ne]:{}},_t=function(t){return Xt(t,ne)}}var re={set:Mt,get:It,has:_t,enforce:function(t){return _t(t)?It(t):Mt(t,{})},getterFor:function(t){return function(e){var n;if(!Ut(e)||(n=It(e)).type!==t)throw TypeError("Incompatible receiver, "+t+" required");return n}}},oe=v,ie=function(t){return Object(oe(t))},ce=!o((function(){function t(){}return t.prototype.constructor=null,Object.getPrototypeOf(new t)!==t.prototype})),ae=C,se=ie,le=ce,ue=Ht("IE_PROTO"),fe=Object.prototype,de=le?Object.getPrototypeOf:function(t){return t=se(t),ae(t,ue)?t[ue]:"function"==typeof t.constructor&&t instanceof t.constructor?t.constructor.prototype:t instanceof Object?fe:null},he=o,pe=!!Object.getOwnPropertySymbols&&!he((function(){return!String(Symbol())})),ye=pe&&!Symbol.sham&&"symbol"==typeof Symbol.iterator,ve=n,ge=jt.exports,me=C,xe=zt,be=pe,Se=ye,we=ge("wks"),Oe=ve.Symbol,Ce=Se?Oe:Oe&&Oe.withoutSetter||xe,Te=function(t){return me(we,t)||(be&&me(Oe,t)?we[t]=Oe[t]:we[t]=Ce("Symbol."+t)),we[t]},Ee=de;Te("iterator");var Ae,Re,ke,Ne=!1;[].keys&&("next"in(ke=[].keys())?(Re=Ee(Ee(ke)))!==Object.prototype&&(Ae=Re):Ne=!0),null==Ae&&(Ae={});var Pe,je={IteratorPrototype:Ae,BUGGY_SAFARI_ITERATORS:Ne},Le=Math.ceil,Me=Math.floor,Ie=function(t){return isNaN(t=+t)?0:(t>0?Me:Le)(t)},_e=Ie,De=Math.min,Fe=function(t){return t>0?De(_e(t),9007199254740991):0},ze=Ie,Be=Math.max,We=Math.min,Ge=function(t,e){var n=ze(t);return n<0?Be(n+e,0):We(n,e)},He=x,Ke=Fe,Ye=Ge,Ue=function(t){return function(e,n,r){var o,i=He(e),c=Ke(i.length),a=Ye(r,c);if(t&&n!=n){for(;c>a;)if((o=i[a++])!=o)return!0}else for(;c>a;a++)if((t||a in i)&&i[a]===n)return t||a||0;return!t&&-1}},Ve={includes:Ue(!0),indexOf:Ue(!1)},Xe=C,$e=x,Je=Ve.indexOf,qe=Kt,Qe=function(t,e){var n,r=$e(t),o=0,i=[];for(n in r)!Xe(qe,n)&&Xe(r,n)&&i.push(n);for(;e.length>o;)Xe(r,n=e[o++])&&(~Je(i,n)||i.push(n));return i},Ze=["constructor","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","toLocaleString","toString","valueOf"],tn=Qe,en=Ze,nn=Object.keys||function(t){return tn(t,en)},rn=J,on=Q,cn=nn,an=i?Object.defineProperties:function(t,e){on(t);for(var n,r=cn(e),o=r.length,i=0;o>i;)rn.f(t,n=r[i++],e[n]);return t},sn=V,ln=n,un=function(t){return"function"==typeof t?t:void 0},fn=function(t,e){return arguments.length<2?un(sn[t])||un(ln[t]):sn[t]&&sn[t][e]||ln[t]&&ln[t][e]},dn=fn("document","documentElement"),hn=Q,pn=an,yn=Ze,vn=Kt,gn=dn,mn=R,xn=Ht("IE_PROTO"),bn=function(){},Sn=function(t){return"<script>"+t+"<\/script>"},wn=function(){try{Pe=document.domain&&new ActiveXObject("htmlfile")}catch(t){}var t,e;wn=Pe?function(t){t.write(Sn("")),t.close();var e=t.parentWindow.Object;return t=null,e}(Pe):((e=mn("iframe")).style.display="none",gn.appendChild(e),e.src=String("javascript:"),(t=e.contentWindow.document).open(),t.write(Sn("document.F=Object")),t.close(),t.F);for(var n=yn.length;n--;)delete wn.prototype[yn[n]];return wn()};vn[xn]=!0;var On=Object.create||function(t,e){var n;return null!==t?(bn.prototype=hn(t),n=new bn,bn.prototype=null,n[xn]=t):n=wn(),void 0===e?n:pn(n,e)},Cn={};Cn[Te("toStringTag")]="z";var Tn="[object z]"===String(Cn),En=Tn,An=d,Rn=Te("toStringTag"),kn="Arguments"==An(function(){return arguments}()),Nn=En?An:function(t){var e,n,r;return void 0===t?"Undefined":null===t?"Null":"string"==typeof(n=function(t,e){try{return t[e]}catch(t){}}(e=Object(t),Rn))?n:kn?An(e):"Object"==(r=An(e))&&"function"==typeof e.callee?"Arguments":r},Pn=Nn,jn=Tn?{}.toString:function(){return"[object "+Pn(this)+"]"},Ln=Tn,Mn=J.f,In=ct,_n=C,Dn=jn,Fn=Te("toStringTag"),zn=function(t,e,n,r){if(t){var o=n?t:t.prototype;_n(o,Fn)||Mn(o,Fn,{configurable:!0,value:e}),r&&!Ln&&In(o,"toString",Dn)}},Bn=je.IteratorPrototype,Wn=On,Gn=u,Hn=zn,Kn=wt,Yn=function(){return this};Object.setPrototypeOf||"__proto__"in{}&&function(){var t,e=!1,n={};try{(t=Object.getOwnPropertyDescriptor(Object.prototype,"__proto__").set).call(n,[]),e=n instanceof Array}catch(t){}}();var Un=ct,Vn=function(t,e,n,r){r&&r.enumerable?t[e]=n:Un(t,e,n)},Xn=yt,$n=function(t,e,n){var r=e+" Iterator";return t.prototype=Wn(Bn,{next:Gn(1,n)}),Hn(t,r,!1,!0),Kn[r]=Yn,t},Jn=de,qn=zn,Qn=ct,Zn=Vn,tr=wt,er=je.IteratorPrototype,nr=je.BUGGY_SAFARI_ITERATORS,rr=Te("iterator"),or=function(){return this},ir=function(t,e,n,r,o,i,c){$n(n,e,r);var a,s,l,u=function(t){if(t===o&&y)return y;if(!nr&&t in h)return h[t];switch(t){case"keys":case"values":case"entries":return function(){return new n(this,t)}}return function(){return new n(this)}},f=e+" Iterator",d=!1,h=t.prototype,p=h[rr]||h["@@iterator"]||o&&h[o],y=!nr&&p||u(o),v="Array"==e&&h.entries||p;if(v&&(a=Jn(v.call(new t)),er!==Object.prototype&&a.next&&(qn(a,f,!0,!0),tr[f]=or)),"values"==o&&p&&"values"!==p.name&&(d=!0,y=function(){return p.call(this)}),c&&h[rr]!==y&&Qn(h,rr,y),tr[e]=y,o)if(s={values:u("values"),keys:i?y:u("keys"),entries:u("entries")},c)for(l in s)(nr||d||!(l in h))&&Zn(h,l,s[l]);else Xn({target:e,proto:!0,forced:nr||d},s);return s},cr=x,ar=wt,sr=re,lr=ir,ur=sr.set,fr=sr.getterFor("Array Iterator");lr(Array,"Array",(function(t,e){ur(this,{type:"Array Iterator",target:cr(t),index:0,kind:e})}),(function(){var t=fr(this),e=t.target,n=t.kind,r=t.index++;return!e||r>=e.length?(t.target=void 0,{value:void 0,done:!0}):"keys"==n?{value:r,done:!1}:"values"==n?{value:e[r],done:!1}:{value:[r,e[r]],done:!1}}),"values"),ar.Arguments=ar.Array;var dr={CSSRuleList:0,CSSStyleDeclaration:0,CSSValueList:0,ClientRectList:0,DOMRectList:0,DOMStringList:0,DOMTokenList:1,DataTransferItemList:0,FileList:0,HTMLAllCollection:0,HTMLCollection:0,HTMLFormElement:0,HTMLSelectElement:0,MediaList:0,MimeTypeArray:0,NamedNodeMap:0,NodeList:1,PaintRequestList:0,Plugin:0,PluginArray:0,SVGLengthList:0,SVGNumberList:0,SVGPathSegList:0,SVGPointList:0,SVGStringList:0,SVGTransformList:0,SourceBufferList:0,StyleSheetList:0,TextTrackCueList:0,TextTrackList:0,TouchList:0},hr=n,pr=Nn,yr=ct,vr=wt,gr=Te("toStringTag");for(var mr in dr){var xr=hr[mr],br=xr&&xr.prototype;br&&pr(br)!==gr&&yr(br,gr,mr),vr[mr]=vr.Array}var Sr=Ie,wr=v,Or=function(t){return function(e,n){var r,o,i=String(wr(e)),c=Sr(n),a=i.length;return c<0||c>=a?t?"":void 0:(r=i.charCodeAt(c))<55296||r>56319||c+1===a||(o=i.charCodeAt(c+1))<56320||o>57343?t?i.charAt(c):r:t?i.slice(c,c+2):o-56320+(r-55296<<10)+65536}},Cr={codeAt:Or(!1),charAt:Or(!0)}.charAt,Tr=re,Er=ir,Ar=Tr.set,Rr=Tr.getterFor("String Iterator");Er(String,"String",(function(t){Ar(this,{type:"String Iterator",string:String(t),index:0})}),(function(){var t,e=Rr(this),n=e.string,r=e.index;return r>=n.length?{value:void 0,done:!0}:(t=Cr(n,r),e.index+=t.length,{value:t,done:!1})}));var kr,Nr,Pr=Nn,jr=wt,Lr=Te("iterator"),Mr=function(t){if(null!=t)return t[Lr]||t["@@iterator"]||jr[Pr(t)]},Ir=Q,_r=Mr,Dr=function(t){var e=_r(t);if("function"!=typeof e)throw TypeError(String(t)+" is not iterable");return Ir(e.call(t))},Fr=Nn,zr=wt,Br=Te("iterator"),Wr=function(t){var e=Object(t);return void 0!==e[Br]||"@@iterator"in e||zr.hasOwnProperty(Fr(e))},Gr=w,Hr=J,Kr=u,Yr=function(t,e,n){var r=Gr(e);r in t?Hr.f(t,r,Kr(0,n)):t[r]=n},Ur=b,Vr=gt,Xr=Te("species"),$r=function(t,e){var n;return Vr(t)&&("function"!=typeof(n=t.constructor)||n!==Array&&!Vr(n.prototype)?Ur(n)&&null===(n=n[Xr])&&(n=void 0):n=void 0),new(void 0===n?Array:n)(0===e?0:e)},Jr=fn("navigator","userAgent")||"",qr=Jr,Qr=n.process,Zr=Qr&&Qr.versions,to=Zr&&Zr.v8;to?Nr=(kr=to.split("."))[0]+kr[1]:qr&&(!(kr=qr.match(/Edge\/(\d+)/))||kr[1]>=74)&&(kr=qr.match(/Chrome\/(\d+)/))&&(Nr=kr[1]);var eo=Nr&&+Nr,no=o,ro=eo,oo=Te("species"),io=function(t){return ro>=51||!no((function(){var e=[];return(e.constructor={})[oo]=function(){return{foo:1}},1!==e[t](Boolean).foo}))},co=yt,ao=o,so=gt,lo=b,uo=ie,fo=Fe,ho=Yr,po=$r,yo=io,vo=eo,go=Te("isConcatSpreadable"),mo=vo>=51||!ao((function(){var t=[];return t[go]=!1,t.concat()[0]!==t})),xo=yo("concat"),bo=function(t){if(!lo(t))return!1;var e=t[go];return void 0!==e?!!e:so(t)};co({target:"Array",proto:!0,forced:!mo||!xo},{concat:function(t){var e,n,r,o,i,c=uo(this),a=po(c,0),s=0;for(e=-1,r=arguments.length;e<r;e++)if(bo(i=-1===e?c:arguments[e])){if(s+(o=fo(i.length))>9007199254740991)throw TypeError("Maximum allowed index exceeded");for(n=0;n<o;n++,s++)n in i&&ho(a,s,i[n])}else{if(s>=9007199254740991)throw TypeError("Maximum allowed index exceeded");ho(a,s++,i)}return a.length=s,a}});var So={},wo=Qe,Oo=Ze.concat("length","prototype");So.f=Object.getOwnPropertyNames||function(t){return wo(t,Oo)};var Co={},To=x,Eo=So.f,Ao={}.toString,Ro="object"==typeof window&&window&&Object.getOwnPropertyNames?Object.getOwnPropertyNames(window):[];Co.f=function(t){return Ro&&"[object Window]"==Ao.call(t)?function(t){try{return Eo(t)}catch(t){return Ro.slice()}}(t):Eo(To(t))};var ko={};ko.f=Object.getOwnPropertySymbols;var No={},Po=Te;No.f=Po;var jo=V,Lo=C,Mo=No,Io=J.f,_o=function(t){var e=jo.Symbol||(jo.Symbol={});Lo(e,t)||Io(e,t,{value:Mo.f(t)})},Do=$,Fo=y,zo=ie,Bo=Fe,Wo=$r,Go=[].push,Ho=function(t){var e=1==t,n=2==t,r=3==t,o=4==t,i=6==t,c=5==t||i;return function(a,s,l,u){for(var f,d,h=zo(a),p=Fo(h),y=Do(s,l,3),v=Bo(p.length),g=0,m=u||Wo,x=e?m(a,v):n?m(a,0):void 0;v>g;g++)if((c||g in p)&&(d=y(f=p[g],g,h),t))if(e)x[g]=d;else if(d)switch(t){case 3:return!0;case 5:return f;case 6:return g;case 2:Go.call(x,f)}else if(o)return!1;return i?-1:r||o?o:x}},Ko={forEach:Ho(0),map:Ho(1),filter:Ho(2),some:Ho(3),every:Ho(4),find:Ho(5),findIndex:Ho(6)},Yo=yt,Uo=n,Vo=fn,Xo=i,$o=pe,Jo=ye,qo=o,Qo=C,Zo=gt,ti=b,ei=Q,ni=ie,ri=x,oi=w,ii=u,ci=On,ai=nn,si=So,li=Co,ui=ko,fi=r,di=J,hi=c,pi=ct,yi=Vn,vi=jt.exports,gi=Kt,mi=zt,xi=Te,bi=No,Si=_o,wi=zn,Oi=re,Ci=Ko.forEach,Ti=Ht("hidden"),Ei=xi("toPrimitive"),Ai=Oi.set,Ri=Oi.getterFor("Symbol"),ki=Object.prototype,Ni=Uo.Symbol,Pi=Vo("JSON","stringify"),ji=fi.f,Li=di.f,Mi=li.f,Ii=hi.f,_i=vi("symbols"),Di=vi("op-symbols"),Fi=vi("string-to-symbol-registry"),zi=vi("symbol-to-string-registry"),Bi=vi("wks"),Wi=Uo.QObject,Gi=!Wi||!Wi.prototype||!Wi.prototype.findChild,Hi=Xo&&qo((function(){return 7!=ci(Li({},"a",{get:function(){return Li(this,"a",{value:7}).a}})).a}))?function(t,e,n){var r=ji(ki,e);r&&delete ki[e],Li(t,e,n),r&&t!==ki&&Li(ki,e,r)}:Li,Ki=function(t,e){var n=_i[t]=ci(Ni.prototype);return Ai(n,{type:"Symbol",tag:t,description:e}),Xo||(n.description=e),n},Yi=Jo?function(t){return"symbol"==typeof t}:function(t){return Object(t)instanceof Ni},Ui=function(t,e,n){t===ki&&Ui(Di,e,n),ei(t);var r=oi(e,!0);return ei(n),Qo(_i,r)?(n.enumerable?(Qo(t,Ti)&&t[Ti][r]&&(t[Ti][r]=!1),n=ci(n,{enumerable:ii(0,!1)})):(Qo(t,Ti)||Li(t,Ti,ii(1,{})),t[Ti][r]=!0),Hi(t,r,n)):Li(t,r,n)},Vi=function(t,e){ei(t);var n=ri(e),r=ai(n).concat(qi(n));return Ci(r,(function(e){Xo&&!Xi.call(n,e)||Ui(t,e,n[e])})),t},Xi=function(t){var e=oi(t,!0),n=Ii.call(this,e);return!(this===ki&&Qo(_i,e)&&!Qo(Di,e))&&(!(n||!Qo(this,e)||!Qo(_i,e)||Qo(this,Ti)&&this[Ti][e])||n)},$i=function(t,e){var n=ri(t),r=oi(e,!0);if(n!==ki||!Qo(_i,r)||Qo(Di,r)){var o=ji(n,r);return!o||!Qo(_i,r)||Qo(n,Ti)&&n[Ti][r]||(o.enumerable=!0),o}},Ji=function(t){var e=Mi(ri(t)),n=[];return Ci(e,(function(t){Qo(_i,t)||Qo(gi,t)||n.push(t)})),n},qi=function(t){var e=t===ki,n=Mi(e?Di:ri(t)),r=[];return Ci(n,(function(t){!Qo(_i,t)||e&&!Qo(ki,t)||r.push(_i[t])})),r};if($o||(yi((Ni=function(){if(this instanceof Ni)throw TypeError("Symbol is not a constructor");var t=arguments.length&&void 0!==arguments[0]?String(arguments[0]):void 0,e=mi(t),n=function(t){this===ki&&n.call(Di,t),Qo(this,Ti)&&Qo(this[Ti],e)&&(this[Ti][e]=!1),Hi(this,e,ii(1,t))};return Xo&&Gi&&Hi(ki,e,{configurable:!0,set:n}),Ki(e,t)}).prototype,"toString",(function(){return Ri(this).tag})),yi(Ni,"withoutSetter",(function(t){return Ki(mi(t),t)})),hi.f=Xi,di.f=Ui,fi.f=$i,si.f=li.f=Ji,ui.f=qi,bi.f=function(t){return Ki(xi(t),t)},Xo&&Li(Ni.prototype,"description",{configurable:!0,get:function(){return Ri(this).description}})),Yo({global:!0,wrap:!0,forced:!$o,sham:!$o},{Symbol:Ni}),Ci(ai(Bi),(function(t){Si(t)})),Yo({target:"Symbol",stat:!0,forced:!$o},{for:function(t){var e=String(t);if(Qo(Fi,e))return Fi[e];var n=Ni(e);return Fi[e]=n,zi[n]=e,n},keyFor:function(t){if(!Yi(t))throw TypeError(t+" is not a symbol");if(Qo(zi,t))return zi[t]},useSetter:function(){Gi=!0},useSimple:function(){Gi=!1}}),Yo({target:"Object",stat:!0,forced:!$o,sham:!Xo},{create:function(t,e){return void 0===e?ci(t):Vi(ci(t),e)},defineProperty:Ui,defineProperties:Vi,getOwnPropertyDescriptor:$i}),Yo({target:"Object",stat:!0,forced:!$o},{getOwnPropertyNames:Ji,getOwnPropertySymbols:qi}),Yo({target:"Object",stat:!0,forced:qo((function(){ui.f(1)}))},{getOwnPropertySymbols:function(t){return ui.f(ni(t))}}),Pi){var Qi=!$o||qo((function(){var t=Ni();return"[null]"!=Pi([t])||"{}"!=Pi({a:t})||"{}"!=Pi(Object(t))}));Yo({target:"JSON",stat:!0,forced:Qi},{stringify:function(t,e,n){for(var r,o=[t],i=1;arguments.length>i;)o.push(arguments[i++]);if(r=e,(ti(e)||void 0!==t)&&!Yi(t))return Zo(e)||(e=function(t,e){if("function"==typeof r&&(e=r.call(this,t,e)),!Yi(e))return e}),o[1]=e,Pi.apply(null,o)}})}Ni.prototype[Ei]||pi(Ni.prototype,Ei,Ni.prototype.valueOf),wi(Ni,"Symbol"),gi[Ti]=!0,_o("asyncIterator"),_o("hasInstance"),_o("isConcatSpreadable"),_o("iterator"),_o("match"),_o("matchAll"),_o("replace"),_o("search"),_o("species"),_o("split"),_o("toPrimitive"),_o("toStringTag"),_o("unscopables"),zn(Math,"Math",!0),zn(n.JSON,"JSON",!0);var Zi=V.Symbol;_o("asyncDispose"),_o("dispose"),_o("observable"),_o("patternMatch"),_o("replaceAll");var tc=Zi,ec=Dr,nc=Wr,rc=tc;var oc=function(t,e){if(void 0!==rc&&nc(Object(t))){var n=[],r=!0,o=!1,i=void 0;try{for(var c,a=ec(t);!(r=(c=a.next()).done)&&(n.push(c.value),!e||n.length!==e);r=!0);}catch(t){o=!0,i=t}finally{try{r||null==a.return||a.return()}finally{if(o)throw i}}return n}},ic=Q,cc=wt,ac=Te("iterator"),sc=Array.prototype,lc=$,uc=ie,fc=function(t,e,n,r){try{return r?e(ic(n)[0],n[1]):e(n)}catch(e){var o=t.return;throw void 0!==o&&ic(o.call(t)),e}},dc=function(t){return void 0!==t&&(cc.Array===t||sc[ac]===t)},hc=Fe,pc=Yr,yc=Mr,vc=Te("iterator"),gc=!1;try{var mc=0,xc={next:function(){return{done:!!mc++}},return:function(){gc=!0}};xc[vc]=function(){return this},Array.from(xc,(function(){throw 2}))}catch(t){}var bc=function(t){var e,n,r,o,i,c,a=uc(t),s="function"==typeof this?this:Array,l=arguments.length,u=l>1?arguments[1]:void 0,f=void 0!==u,d=yc(a),h=0;if(f&&(u=lc(u,l>2?arguments[2]:void 0,2)),null==d||s==Array&&dc(d))for(n=new s(e=hc(a.length));e>h;h++)c=f?u(a[h],h):a[h],pc(n,h,c);else for(i=(o=d.call(a)).next,n=new s;!(r=i.call(o)).done;h++)c=f?fc(o,u,[r.value,h],!0):r.value,pc(n,h,c);return n.length=h,n};yt({target:"Array",stat:!0,forced:!function(t,e){if(!e&&!gc)return!1;var n=!1;try{var r={};r[vc]=function(){return{next:function(){return{done:n=!0}}}},t(r)}catch(t){}return n}((function(t){Array.from(t)}))},{from:bc});var Sc=V.Array.from,wc=i,Oc=o,Cc=C,Tc=Object.defineProperty,Ec={},Ac=function(t){throw t},Rc=function(t,e){if(Cc(Ec,t))return Ec[t];e||(e={});var n=[][t],r=!!Cc(e,"ACCESSORS")&&e.ACCESSORS,o=Cc(e,0)?e[0]:Ac,i=Cc(e,1)?e[1]:void 0;return Ec[t]=!!n&&!Oc((function(){if(r&&!wc)return!0;var t={length:-1};r?Tc(t,1,{enumerable:!0,get:Ac}):t[1]=1,n.call(t,o,i)}))},kc=yt,Nc=b,Pc=gt,jc=Ge,Lc=Fe,Mc=x,Ic=Yr,_c=Te,Dc=Rc,Fc=io("slice"),zc=Dc("slice",{ACCESSORS:!0,0:0,1:2}),Bc=_c("species"),Wc=[].slice,Gc=Math.max;kc({target:"Array",proto:!0,forced:!Fc||!zc},{slice:function(t,e){var n,r,o,i=Mc(this),c=Lc(i.length),a=jc(t,c),s=jc(void 0===e?c:e,c);if(Pc(i)&&("function"!=typeof(n=i.constructor)||n!==Array&&!Pc(n.prototype)?Nc(n)&&null===(n=n[Bc])&&(n=void 0):n=void 0,n===Array||void 0===n))return Wc.call(i,a,s);for(r=new(void 0===n?Array:n)(Gc(s-a,0)),o=0;a<s;a++,o++)a in i&&Ic(r,o,i[a]);return r.length=o,r}});var Hc=V,Kc=function(t){return Hc[t+"Prototype"]},Yc=Kc("Array").slice,Uc=Array.prototype,Vc=function(t){var e=t.slice;return t===Uc||t instanceof Array&&e===Uc.slice?Yc:e};var Xc=function(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r},$c=Sc,Jc=Vc,qc=Xc;var Qc=function(t,e){var n;if(t){if("string"==typeof t)return qc(t,e);var r=Jc(n=Object.prototype.toString.call(t)).call(n,8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?$c(r):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?qc(t,e):void 0}};var Zc=St,ta=oc,ea=Qc,na=function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")};var ra=function(t,e){return Zc(t)||ta(t,e)||ea(t,e)||na()},oa=n,ia=[].slice,ca=function(t){return function(e,n){var r=arguments.length>2,o=r?ia.call(arguments,2):void 0;return t(r?function(){("function"==typeof e?e:Function(e)).apply(this,o)}:e,n)}};yt({global:!0,bind:!0,forced:/MSIE .\./.test(Jr)},{setTimeout:ca(oa.setTimeout),setInterval:ca(oa.setInterval)});var aa=V.setTimeout,sa=o,la=function(t,e){var n=[][t];return!!n&&sa((function(){n.call(null,e||function(){throw 1},1)}))},ua=yt,fa=Ve.indexOf,da=la,ha=Rc,pa=[].indexOf,ya=!!pa&&1/[1].indexOf(1,-0)<0,va=da("indexOf"),ga=ha("indexOf",{ACCESSORS:!0,1:0});ua({target:"Array",proto:!0,forced:ya||!va||!ga},{indexOf:function(t){return ya?pa.apply(this,arguments)||0:fa(this,t,arguments.length>1?arguments[1]:void 0)}});var ma=Kc("Array").indexOf,xa=Array.prototype,ba=function(t){var e=t.indexOf;return t===xa||t instanceof Array&&e===xa.indexOf?ma:e};yt({target:"Date",stat:!0},{now:function(){return(new Date).getTime()}});var Sa=V.Date.now;var wa=function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")},Oa={exports:{}};yt({target:"Object",stat:!0,forced:!i,sham:!i},{defineProperty:J.f});var Ca=V.Object,Ta=Oa.exports=function(t,e,n){return Ca.defineProperty(t,e,n)};Ca.defineProperty.sham&&(Ta.sham=!0);var Ea=Oa.exports,Aa=Ea;function Ra(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Aa(t,r.key,r)}}var ka=function(t,e,n){return e&&Ra(t.prototype,e),n&&Ra(t,n),t},Na=Ea;var Pa=function(t,e,n){return e in t?Na(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t},ja=function(){function t(e,n){wa(this,t),this.node=e,this.offset=n}return ka(t,null,[{key:"getSelectText",value:function(t,e,n,r){var o="";if(t.childNodes.length&&"SCRIPT"!==t.nodeName&&"STYLE"!==t.nodeName){var i=t.childNodes[0];return o+=this.getSelectText(i,e,0,r)}if("#text"===t.nodeName){var c=t===e?r:t.textContent.length;o+=t.textContent.substring(n,c)}if(t===e)return o;var a=t.nextSibling;if(a){o+=this.getSelectText(a,e,0,r)}else{for(var s=t.parentNode;s&&null===s.nextSibling;)s=s.parentNode;if(!s)throw new Error("Invalid end node");o+=this.getSelectText(s.nextSibling,e,0,r)}return o}}]),t}(),La=xt,Ma=Xc;var Ia=Sc,_a=Wr,Da=tc;var Fa=function(t){if(La(t))return Ma(t)},za=function(t){if(void 0!==Da&&_a(Object(t)))return Ia(t)},Ba=Qc,Wa=function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")};var Ga=function(t){return Fa(t)||za(t)||Ba(t)||Wa()},Ha=Vc,Ka=gt,Ya=[].reverse,Ua=[1,2];yt({target:"Array",proto:!0,forced:String(Ua)===String(Ua.reverse())},{reverse:function(){return Ka(this)&&(this.length=this.length),Ya.call(this)}});var Va=Kc("Array").reverse,Xa=Array.prototype,$a=function(t){var e=t.reverse;return t===Xa||t instanceof Array&&e===Xa.reverse?Va:e},Ja=Ko.forEach,qa=Rc,Qa=la("forEach"),Za=qa("forEach"),ts=Qa&&Za?[].forEach:function(t){return Ja(this,t,arguments.length>1?arguments[1]:void 0)};yt({target:"Array",proto:!0,forced:[].forEach!=ts},{forEach:ts});var es=Kc("Array").forEach,ns=Nn,rs=Array.prototype,os={DOMTokenList:!0,NodeList:!0},is=function(t){var e=t.forEach;return t===rs||t instanceof Array&&e===rs.forEach||os.hasOwnProperty(ns(t))?es:e},cs=yt,as=Ko.map,ss=Rc,ls=io("map"),us=ss("map");cs({target:"Array",proto:!0,forced:!ls||!us},{map:function(t){return as(this,t,arguments.length>1?arguments[1]:void 0)}});var fs=Kc("Array").map,ds=Array.prototype,hs=function(t){var e=t.map;return t===ds||t instanceof Array&&e===ds.map?fs:e},ps=mt,ys=function(){function t(e){var n=this,r=e.container,o=e.rectsColor,i=void 0===o?"rgba(23,136,189,0.35)":o;wa(this,t),Pa(this,"setRects",(function(t,e,r){var o;n.reset(),o=ps(t)?t:[t];var i=document.createDocumentFragment();n.elements=hs(o).call(o,(function(t){var o=document.createElement("div");return o.classList.add("mobile-text-selection-tools","mobile-text-selection-tools-rect"),o.style.pointerEvents="none",o.style.width="".concat(t.width,"px"),o.style.height="".concat(t.height,"px"),o.style.backgroundColor=n.rectsColor,o.style.position="absolute",o.style.left="".concat(t.left-e,"px"),o.style.top="".concat(t.top-r,"px"),i.appendChild(o),o})),n.container.appendChild(i)})),Pa(this,"reset",(function(){var t,e,r;is(t=$a(e=Ha(r=n.elements).call(r)).call(e)).call(t,(function(t){return n.container.removeChild(t)})),n.elements=[]})),this.container=r,this.rectsColor=i,this.elements=[]}return ka(t,[{key:"getSelectRects",value:function(t,e,n,r){var o=[];if(t.childNodes.length&&"SCRIPT"!==t.nodeName&&"STYLE"!==t.nodeName){var i=t.childNodes[0],c=this.getSelectRects(i,e,0,r);return o.push.apply(o,Ga(c)),o}if("#text"===t.nodeName){var a=t===e?r:t.textContent.length,s=document.createRange();s.setStart(t,n),s.setEnd(t,a),o.push.apply(o,Ga(s.getClientRects()))}if(t===e)return o;var l=t.nextSibling;if(l){var u=this.getSelectRects(l,e,0,r);o.push.apply(o,Ga(u))}else{var f=t.parentNode;if(f===this.container)return[];for(;f&&(null===f.nextSibling||f===this.container);)f=f.parentNode;if(f&&f===this.container)return[];if(!f)throw new Error("Invalid end node");var d=this.getSelectRects(f.nextSibling,e,0,r);o.push.apply(o,Ga(d))}return o}}]),t}(),vs=Kc("Array").concat,gs=Array.prototype,ms=function(t){var e=t.concat;return t===gs||t instanceof Array&&e===gs.concat?vs:e},xs=function(){function t(e){var n=this,r=e.container,o=e.cursorDom,i=e.type,c=e.color,a=void 0===c?"#1788bd":c;wa(this,t),Pa(this,"createElement",(function(){var t,e=document.createElement("div");if(e.classList.add("mobile-text-selection-tools","mobile-text-selection-tools-cursor"),e.style.userSelect="none",e.style.webkitUserSelect="none",e.style.display="none",e.style.position="absolute",e.style.left="0px",e.style.top="0px",e.style.zIndex=2,e.style.width="".concat(2*n.size,"px"),"start"===n.type&&(e.style.transform="scaleX(-1)"),n.cursorDom&&n.cursorDom instanceof Element)t=n.cursorDom.cloneNode(!0);else{var r;(t=document.createElement("div")).style.boxSizing="border-box",t.style.width="".concat(2*n.size,"px"),t.style.height="".concat(3*n.size,"px");var o=document.createElement("div");o.style.width="0",o.style.height="0",o.style.borderWidth="".concat(n.size/2,"px"),o.style.borderColor=ms(r="transparent transparent ".concat(n.color," ")).call(r,n.color),o.style.borderStyle="solid";var i=document.createElement("div");i.style.width="".concat(n.size,"px"),i.style.height="".concat(n.size,"px"),i.style.backgroundColor=n.color,t.appendChild(o),t.appendChild(i)}return e.appendChild(t),e})),Pa(this,"show",(function(){n.element.style.display="block"})),Pa(this,"hide",(function(){n.element.style.display="none"})),this.container=r,this.element=null,this.cursorDom=o,this.type=i,this._position={x:0,y:0},this.height=0,this.size=15,this.color=a,this.element=this.createElement(),r.appendChild(this.element)}return ka(t,[{key:"moveTo",value:function(t,e){"start"===this.type?this.element.style.left="".concat(t-2*this.size,"px"):this.element.style.left="".concat(t,"px"),this.element.style.top="".concat(e+this.height,"px")}},{key:"position",set:function(t){var e=t.x,n=t.y;this._position={x:e,y:n},this.moveTo(e,n)},get:function(){return this._position}}]),t}(),bs=function(){function t(e){var n=this,r=e.container,o=e.rectsColor,i=e.backgroundColor,c=e.height,a=void 0===c?50:c,s=e.width,l=void 0===s?100:s,u=e.offset,f=void 0===u?50:u;wa(this,t),Pa(this,"moveTo",(function(t,e){var r,o,i,c=n.container.getBoundingClientRect().width,a=n.container.getBoundingClientRect().height;n.slip.style.clipPath=ms(r=ms(o=ms(i="inset(\n        ".concat(e-n.height/2,"px\n        ")).call(i,c-t-n.width/2,"px\n        ")).call(o,a-e-n.height/2,"px\n        ")).call(r,t-n.width/2,"px\n    )"),n.clip.style.top="".concat(e-n.offset-n.height/2,"px"),n.clip.style.left="".concat(t-n.width/2,"px")})),Pa(this,"show",(function(){n.clip.style.display="block",n.slip.style.display="block"})),Pa(this,"hide",(function(){n.clip.style.display="none",n.slip.style.display="none"})),Pa(this,"createSlip",(function(){var t=n.container.cloneNode(!0);return t.classList.add("mobile-text-selection-tools","mobile-text-selection-tools-slip"),t.style.pointerEvents="none",t.style.position="absolute",t.style.marginTop=0,t.style.marginRight=0,t.style.marginBottom=0,t.style.marginLeft=0,t.style.top="".concat(-n.offset,"px"),t.style.left=0,t.style.backgroundColor=n.backgroundColor,t.style.display="none",t.style.zIndex="3",t})),Pa(this,"createClip",(function(){var t=document.createElement("div");return t.classList.add("mobile-text-selection-tools","mobile-text-selection-tools-clip"),t.style.pointerEvent="none",t.style.userSelect="none",t.style.webkitUserSelect="none",t.style.position="absolute",t.style.height="".concat(n.height,"px"),t.style.width="".concat(n.width,"px"),t.style.boxShadow="0px 1px 2px 1px #666, inset 0px 0px 2px 2px #fff",t.style.borderRadius="5px",t.style.display="none",t.style.zIndex="3",t})),this.container=r,this.height=a,this.width=l,this.offset=f,this.backgroundColor=i,this._position={x:0,y:0},this.slip=this.createSlip(),this.clip=this.createClip(),this.rect=null,r.appendChild(this.slip),r.appendChild(this.clip),this.rects=new ys({container:this.slip,rectsColor:o})}return ka(t,[{key:"position",set:function(t){var e=t.x,n=t.y;this._position={x:e,y:n},this.moveTo(e,n)}}]),t}(),Ss=yt,ws=Ko.find,Os=!0,Cs=Rc("find");"find"in[]&&Array(1).find((function(){Os=!1})),Ss({target:"Array",proto:!0,forced:Os||!Cs},{find:function(t){return ws(this,t,arguments.length>1?arguments[1]:void 0)}});var Ts=Kc("Array").find,Es=Array.prototype,As=function(t){var e=t.find;return t===Es||t instanceof Array&&e===Es.find?Ts:e},Rs=function(){function t(e){var n=this,r=e.container,o=e.backgroundColor,i=void 0===o?"#000000":o,c=e.color,a=void 0===c?"#ffffff":c,s=e.menu,l=void 0===s?[]:s;wa(this,t),Pa(this,"moveTo",(function(t,e){n.show();var r=n.element.getBoundingClientRect().width,o=n.element.getBoundingClientRect().height;n.hide();var i=n.container.getBoundingClientRect(),c=t,a=e,s=document.documentElement.clientWidth||document.body.clientWidth;c=t+i.left<r/2+n.paddingLR?n.paddingLR-i.left:t+i.left>s-r/2-n.paddingLR?s-r-i.left-n.paddingLR:t-r/2;var l=1.5*Number(window.getComputedStyle(n.container).fontSize.replace("px",""));a=e+i.top<l+o?e+2.5*l:e-o-l,n.element.style.top="".concat(a,"px"),n.element.style.left="".concat(c,"px")})),Pa(this,"show",(function(){n.element.style.display="block"})),Pa(this,"hide",(function(){n.element.style.display="none"})),Pa(this,"createElement",(function(){var t,e=document.createElement("div");e.classList.add("mobile-text-selection-tools","mobile-text-selection-tools-menu"),e.style.userSelect="none",e.style.webkitUserSelect="none",e.style.display="none",e.style.position="absolute",e.style.left="0px",e.style.top="0px",e.style.zIndex="3",e.style.borderRadius="4px",e.style.overflow="hidden",e.style.boxShadow="0px 1px 2px 1px #666";var r=document.documentElement.clientWidth||document.body.clientWidth;e.style.maxWidth="".concat(r-2*n.paddingLR,"px");var o=document.createElement("div");o.style.overflow="scroll";var i=document.createElement("div");return i.style.display="flex",i.style.alignItems="center",i.style.width="max-content",hs(t=n.menu).call(t,(function(t){var e=document.createElement("div");if(e.style.display="flex",e.style.flex="1 0 auto",e.style.alignItems="center",e.style.padding="10px 15px",e.style.boxSizing="border-box",e.style.boxSizing="border-box",e.style.backgroundColor=n.backgroundColor,!t.key)throw new Error("菜单项需要参数key");if(e.dataset.key=t.key,t.icon){var r=document.createElement("div");r.style.display="flex",r.style.alignItems="center",r.style.justifyContent="center",r.style.marginRight="5px",r.style.maxWidth="1.2em",r.style.maxHeight="1.2em",r.appendChild(t.icon),e.appendChild(r);var o=r.querySelector("img");o&&(o.style.width="100%",o.style.height="100%")}if(t.text){var c=document.createElement("span");c.style.color=n.color,c.innerText=t.text,e.appendChild(c)}if(t.click){if("function"!=typeof t.click)throw Error("参数click类型错误");e.onclick=function(){return t.click(t.key)}}n.menuItemElements.push(e),i.appendChild(e)})),o.appendChild(i),e.appendChild(o),e})),this.container=r,this.backgroundColor=i,this.color=a,this.menu=l,this.paddingLR=10,this.element=null,this.menuItemElements=[],this._position={x:0,y:0},this.element=this.createElement(),r.appendChild(this.element)}return ka(t,[{key:"getSelectMenuKey",value:function(t){var e,n=As(e=this.menuItemElements).call(e,(function(e){return ba(t).call(t,e)>-1}));return n&&n.dataset.key}},{key:"clickMenuItem",value:function(t,e){var n,r=As(n=this.menu).call(n,(function(e){return e.key===t}));r.click&&r.click(e)}},{key:"position",set:function(t){var e=t.x,n=t.y;this._position={x:e,y:n},this.moveTo(e,n)}}]),t}();function ks(t){return t.path||t.composedPath&&t.composedPath()||""}function Ns(t,e,n){return e>=t-n/2&&e<=t+n/2}function Ps(t,e,n){var r=document.createRange();r.setStart(t,e),r.setEnd(t,n);var o=r.getClientRects();return o.length?o[0]:null}function js(t,e){var n=null,r=function(t,e){var n=Ls(t,e);if(n&&n!==e)return n;return null}(t,e);return r&&(n=Ps(r,0,1)),n}function Ls(t,e){var n=null;if(t.classList&&t.classList.contains("mobile-text-selection-tools"))return null;if(t.childNodes.length){var r=t.childNodes[0];n="#text"!==r.nodeName||/^\s+$/.test(r.textContent)?Ls(r,e):r}if(n)return n;for(var o=t.nextSibling;!n&&o;)(n="#text"!==o.nodeName||/^\s+$/.test(o.textContent)?Ls(o,e):o)||(o=o.nextSibling);if(n)return n;for(var i,c=t.parentNode;!i&&c!==e;)i=c.nextSibling,c=c.parentNode;for(;!n&&i;)"#text"!==i.nodeName||/^\s+$/.test(i.textContent)?(n=Ls(i,e))||(i=i.nextSibling):n=i;return n||(c===e?e:n)}var Ms=function(){function t(e){var n=this,r=e.container,o=e.cursorDom,i=e.cursorColor,c=e.rectsColor,a=e.magnifierHeight,s=e.magnifierWidth,l=e.magnifierOffset,u=e.magnifierBackgroundColor,f=e.longTapDuration,d=void 0===f?600:f,h=e.menu,p=e.menuBackgroundColor,y=e.menuColor,v=e.tokenizer,g=void 0===v?function(){}:v,m=e.onFinish,x=void 0===m?function(){}:m,b=e.onStart,S=void 0===b?function(){}:b,w=e.onCancel,O=void 0===w?function(){}:w;if(wa(this,t),Pa(this,"blur",(function(){n.cursor.start.hide(),n.cursor.end.hide(),n.rects.reset(),n.selectStatus="none",n.magnifier.hide(),n.menu.hide(),n.onCancel()})),Pa(this,"init",(function(){n.container.oncontextmenu=function(t){t.preventDefault()},n.container.style.userSelect="none",n.container.style.webkitUserSelect="none",n.container.style.webkitTouchCallout="none",n.magnifier=new bs({container:n.container,rectsColor:n.rectsColor,backgroundColor:n.magnifierBackgroundColor,height:n.magnifierHeight,width:n.magnifierWidth,offset:n.magnifierOffset}),n.container.addEventListener("touchstart",n.handleTouchStart),n.container.addEventListener("touchmove",n.handleTouchMove),n.container.addEventListener("touchend",n.handleTouchEnd),n.container.style.position="relative",n.cursor.start=new xs({container:n.container,cursorDom:n.cursorDom,type:"start",color:n.cursorColor}),n.cursor.end=new xs({container:n.container,cursorDom:n.cursorDom,type:"end",color:n.cursorColor}),n.rects=new ys({container:n.container,rectsColor:n.rectsColor}),n.menu=new Rs({container:n.container,menu:n.menu,backgroundColor:n.menuBackgroundColor,color:n.menuColor})})),Pa(this,"destroy",(function(){n.container.oncontextmenu=null,n.container.removeEventListener("touchstart",n.handleTouchStart),n.container.removeEventListener("touchmove",n.handleTouchMove),n.container.removeEventListener("touchend",n.handleTouchEnd);for(var t=n.container.getElementsByClassName("mobile-text-selection-tools"),e=t.length-1;e>=0;e--)t[e].remove();n.container._textSelection=null})),Pa(this,"handleTouchStart",(function(t){var e,r,o,i=t,c=t.changedTouches[0],a=c.clientX,s=c.clientY;n.touchStartTime=Sa(),n.touchStartPosition={x:a,y:s};var l=ba(e=ks(i)).call(e,n.menu.element)>-1,u=ba(r=ks(i)).call(r,n.cursor.start.element)>-1,f=ba(o=ks(i)).call(o,n.cursor.end.element)>-1;l?(n.touchingMenuKey=n.menu.getSelectMenuKey(ks(i)),i.stopPropagation()):(n.menu.hide(),u?(n.movingCursor=n.cursor.start,n.selectStatus="selecting",i.stopPropagation()):f?(n.movingCursor=n.cursor.end,n.selectStatus="selecting",i.stopPropagation()):n.longTapTimer=aa((function(){i.stopPropagation(),n.onStart(),i.target&&(n.magnifier.show(),n.handleLongTap(i.target,a,s)),n.selectStatus="selecting"}),n.longTapDuration))})),Pa(this,"handleTouchMove",(function(t){var e=t;if("selecting"===n.selectStatus){e.stopPropagation(),e.preventDefault();var r=e.changedTouches[0],o=r.clientX,i=r.clientY,c=n.container.getBoundingClientRect();if(i<c.top&&(i=c.top),i>c.bottom&&(i=c.bottom),o<c.left&&(o=c.left),o>c.right&&(o=c.right),n.movingCursor){n.onStart(),n.movingCursor.hide();var a=document.elementFromPoint(o,i);a&&a instanceof HTMLIFrameElement&&(a=a.contentWindow.document.elementFromPoint(o,i)),n.cursor.start.show(),n.cursor.end.show(),a&&(n.magnifier.show(),n.moveCursor(a,o,i))}else if(n.rects){var s=document.elementFromPoint(o,i);s&&s instanceof HTMLIFrameElement&&(s=s.contentWindow.document.elementFromPoint(o,i)),s&&(n.magnifier.show(),n.handleLongTap(s,o,i))}}else if(n.touchingMenuKey){var l=n.menu.getSelectMenuKey(ks(e));l&&l===n.touchingMenuKey||(n.touchingMenuKey=null)}clearTimeout(n.longTapTimer),n.longTapTimer=null})),Pa(this,"handleTouchEnd",(function(t){var e=t;clearTimeout(n.longTapTimer),n.longTapTimer=null,n.movingCursor=null,n.magnifier.hide();var r=e.changedTouches[0];if(n.touchingMenuKey){var o=n.getText();n.menu.clickMenuItem(n.touchingMenuKey,{text:o}),n.touchingMenuKey=null,n.blur()}else if(Sa()-n.touchStartTime<n.longTapDuration&&r.clientX===n.touchStartPosition.x&&r.clientY===n.touchStartPosition.y)n.blur();else{e.stopPropagation();var i=n.getText();n.rects.elements.length&&i&&(n.menu.position={x:(n.cursor.start.position.x+n.cursor.end.position.x)/2,y:n.cursor.start.position.y},n.menu.show(),n.onFinish({text:i,startX:n.cursor.start.position.x,startY:n.cursor.start.position.y,endX:n.cursor.end.position.x,endY:n.cursor.end.position.y}),n.selectStatus="finished")}})),Pa(this,"getText",(function(){if(n.textNode.start&&n.textNode.end)return ja.getSelectText(n.textNode.start.node,n.textNode.end.node,n.textNode.start.offset,n.textNode.end.offset)})),Pa(this,"moveCursor",(function(t,e,r){if(t&&!/^\s+$/.test(t)){var o=n.getMoveOrTapRectPosition(t,e,r)||{},i=o.x,c=o.y,a=o.node,s=o.index,l=o.height,u=i-n.screenRelativeOffset.x,f=c-n.screenRelativeOffset.y;if(a&&(u||f)){var d=n.movingCursor===n.cursor.start?n.cursor.end:n.cursor.start;if(d.position.x===u&&d.position.y===f)return n.cursor.start.hide(),n.cursor.end.hide(),void n.rects.reset();if(n.movingCursor===n.cursor.start){var h=n.cursor.end.position;if(!(function(t,e,n){return e<t-n/2}(h.y,f,l)||Ns(h.y,f,l)&&u<h.x))return n.cursor.start.position=n.cursor.end.position,n.movingCursor=n.cursor.end,n.textNode.start=new ja(n.textNode.end.node,n.textNode.end.offset),void(n.textNode.end=new ja(a,s));n.textNode.start=new ja(a,s)}else{var p=n.cursor.start.position;if(!(function(t,e,n){return e>t+n/2}(p.y,f,l)||Ns(p.y,f,l)&&u>p.x))return n.cursor.end.position=n.cursor.start.position,n.movingCursor=n.cursor.start,n.textNode.end=new ja(n.textNode.start.node,n.textNode.start.offset),void(n.textNode.start=new ja(a,s));n.textNode.end=new ja(a,s)}n.movingCursor.position={x:i-n.screenRelativeOffset.x,y:c-n.screenRelativeOffset.y},n.magnifier.position={x:i-n.screenRelativeOffset.x,y:c-n.screenRelativeOffset.y};var y=n.rects.getSelectRects(n.textNode.start.node,n.textNode.end.node,n.textNode.start.offset,n.textNode.end.offset);y.length&&(n.rects.setRects(y,n.screenRelativeOffset.x,n.screenRelativeOffset.y),n.magnifier.rects.setRects(y,n.screenRelativeOffset.x,n.screenRelativeOffset.y))}}})),Pa(this,"handleLongTap",(function(t,e,r){n.magnifier.position={x:e-n.screenRelativeOffset.x,y:r-n.screenRelativeOffset.y};var o=n.getMoveOrTapRectPosition(t,e,r)||{},i=o.node,c=o.rect,a=o.index,s=o.height;if(c&&(!c||0!==c.length)){var l=n.tokenizer&&n.tokenizer(i,a)||[-1,0],u=ra(l,2),f=u[0],d=u[1];if("number"==typeof f&&"number"==typeof d&&f>-1&&d>1){n.textNode.start=new ja(i,f),n.textNode.end=new ja(i,f+d);var h=n.rects.getSelectRects(n.textNode.start.node,n.textNode.end.node,n.textNode.start.offset,n.textNode.end.offset);h.length&&(n.rects.setRects(h,n.screenRelativeOffset.x,n.screenRelativeOffset.y),n.cursor.start.height=s,n.cursor.end.height=s,n.cursor.start.position={x:h[0].x-n.screenRelativeOffset.x,y:h[0].y-n.screenRelativeOffset.y},n.cursor.end.position={x:h[h.length-1].x+h[h.length-1].width-n.screenRelativeOffset.x,y:h[h.length-1].y-n.screenRelativeOffset.y},n.cursor.start.show(),n.cursor.end.show(),n.magnifier.rects.setRects(h,n.screenRelativeOffset.x,n.screenRelativeOffset.y))}else n.textNode.start=new ja(i,a),n.textNode.end=new ja(i,a+1),n.rects.setRects(c,n.screenRelativeOffset.x,n.screenRelativeOffset.y),n.cursor.start.height=s,n.cursor.end.height=s,n.cursor.start.position={x:c.x-n.screenRelativeOffset.x,y:c.y-n.screenRelativeOffset.y},n.cursor.end.position={x:c.x+c.width-n.screenRelativeOffset.x,y:c.y-n.screenRelativeOffset.y},n.cursor.start.show(),n.cursor.end.show(),n.magnifier.rects.setRects(c,n.screenRelativeOffset.x,n.screenRelativeOffset.y)}})),Pa(this,"getMoveOrTapRectPosition",(function(t,e,r){if(!n.container.contains(t))return null;if("#comment"===t.nodeName||t.classList.contains("mobile-text-selection-tools"))return null;if(!t||t&&!t.childNodes)return null;for(var o=Number(window.getComputedStyle(t).lineHeight.replace("px","")),i=0;i<t.childNodes.length;i++){var c=t.childNodes[i];if("#text"===c.nodeName){var a=c.textContent;window.getSelection().removeAllRanges();for(var s=0;s<a.length;s++){var l=Ps(c,s,s+1);if(l){var u=(o=o||l.height)/2;if(l.left<e&&l.top-u<r&&l.bottom+u>r){var f=null;if(f=s===a.length-1?js(c,n.container):Ps(c,s+1,s+2),l.right>e)return{x:l.left,y:l.top,node:c,index:s,height:l.height,width:l.width,rect:l};if(!f||f&&f.right<l.left)return{x:l.right,y:l.top,node:c,index:s+1,height:l.height,width:l.width,rect:l}}}}}else{if("#comment"===c.nodeName||c.classList.contains("mobile-text-selection-tools"))continue;var d=n.getMoveOrTapRectPosition(c,e,r);if(d)return d}}return null})),!r)throw Error("TextSelection 容器不能为空");if(g&&"function"!=typeof g)throw Error("参数tokenizer类型错误");if(x&&"function"!=typeof x)throw Error("参数onFinish类型错误");if(S&&"function"!=typeof S)throw Error("参数onStart类型错误");if(O&&"function"!=typeof O)throw Error("参数onCancel类型错误");r._textSelection&&r._textSelection.destroy(),this.container=r,this.longTapTimer=null,this.longTapDuration=d,this.touchStartPosition={x:0,y:0},this.touchStartTime=null,this.touchMoveDuration=0,this.cursorColor=i,this.cursorDom=o,this.cursor={start:null,end:null},this.textNode={start:null,end:null},this.movingCursor=null,this.touchingMenuKey=null,this.mask=null,this.selectStatus="none",this.tokenizer=g,this.onFinish=x,this.onStart=S,this.onCancel=O,this.rects=null,this.rectsColor=c,this.magnifier=null,this.magnifierHeight=a,this.magnifierWidth=s,this.magnifierOffset=l,this.magnifierBackgroundColor=u,this.menu=h,this.menuBackgroundColor=p,this.menuColor=y,r._textSelection=this}return ka(t,[{key:"screenRelativeOffset",get:function(){var t=this.container.getBoundingClientRect(),e=t.top;return{x:t.left,y:e}}}]),t}();export{Ms as default};
