/*! mobile-text-selection 0.2.0*/
!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e():"function"==typeof define&&define.amd?define(e):(t="undefined"!=typeof globalThis?globalThis:t||self).TextSelection=e()}(this,(function(){"use strict";var t="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},e=function(t){return t&&t.Math==Math&&t},n=e("object"==typeof globalThis&&globalThis)||e("object"==typeof window&&window)||e("object"==typeof self&&self)||e("object"==typeof t&&t)||Function("return this")(),r={},o=function(t){try{return!!t()}catch(t){return!0}},i=!o((function(){return 7!=Object.defineProperty({},1,{get:function(){return 7}})[1]})),c={},s={}.propertyIsEnumerable,a=Object.getOwnPropertyDescriptor,l=a&&!s.call({1:2},1);c.f=l?function(t){var e=a(this,t);return!!e&&e.enumerable}:s;var u=function(t,e){return{enumerable:!(1&t),configurable:!(2&t),writable:!(4&t),value:e}},f={}.toString,d=function(t){return f.call(t).slice(8,-1)},h=d,p="".split,y=o((function(){return!Object("z").propertyIsEnumerable(0)}))?function(t){return"String"==h(t)?p.call(t,""):Object(t)}:Object,v=function(t){if(null==t)throw TypeError("Can't call method on "+t);return t},g=y,m=v,x=function(t){return g(m(t))},b=function(t){return"object"==typeof t?null!==t:"function"==typeof t},S=b,w=function(t,e){if(!S(t))return t;var n,r;if(e&&"function"==typeof(n=t.toString)&&!S(r=n.call(t)))return r;if("function"==typeof(n=t.valueOf)&&!S(r=n.call(t)))return r;if(!e&&"function"==typeof(n=t.toString)&&!S(r=n.call(t)))return r;throw TypeError("Can't convert object to primitive value")},O={}.hasOwnProperty,C=function(t,e){return O.call(t,e)},T=b,E=n.document,A=T(E)&&T(E.createElement),R=function(t){return A?E.createElement(t):{}},k=R,N=!i&&!o((function(){return 7!=Object.defineProperty(k("div"),"a",{get:function(){return 7}}).a})),P=i,j=c,L=u,M=x,I=w,D=C,_=N,F=Object.getOwnPropertyDescriptor;r.f=P?F:function(t,e){if(t=M(t),e=I(e,!0),_)try{return F(t,e)}catch(t){}if(D(t,e))return L(!j.f.call(t,e),t[e])};var z=o,B=/#|\.prototype\./,W=function(t,e){var n=H[G(t)];return n==Y||n!=K&&("function"==typeof e?z(e):!!e)},G=W.normalize=function(t){return String(t).replace(B,".").toLowerCase()},H=W.data={},K=W.NATIVE="N",Y=W.POLYFILL="P",U=W,V={},X=function(t){if("function"!=typeof t)throw TypeError(String(t)+" is not a function");return t},$=function(t,e,n){if(X(t),void 0===e)return t;switch(n){case 0:return function(){return t.call(e)};case 1:return function(n){return t.call(e,n)};case 2:return function(n,r){return t.call(e,n,r)};case 3:return function(n,r,o){return t.call(e,n,r,o)}}return function(){return t.apply(e,arguments)}},J={},q=b,Q=function(t){if(!q(t))throw TypeError(String(t)+" is not an object");return t},Z=i,tt=N,et=Q,nt=w,rt=Object.defineProperty;J.f=Z?rt:function(t,e,n){if(et(t),e=nt(e,!0),et(n),tt)try{return rt(t,e,n)}catch(t){}if("get"in n||"set"in n)throw TypeError("Accessors not supported");return"value"in n&&(t[e]=n.value),t};var ot=J,it=u,ct=i?function(t,e,n){return ot.f(t,e,it(1,n))}:function(t,e,n){return t[e]=n,t},st=n,at=r.f,lt=U,ut=V,ft=$,dt=ct,ht=C,pt=function(t){var e=function(e,n,r){if(this instanceof t){switch(arguments.length){case 0:return new t;case 1:return new t(e);case 2:return new t(e,n)}return new t(e,n,r)}return t.apply(this,arguments)};return e.prototype=t.prototype,e},yt=function(t,e){var n,r,o,i,c,s,a,l,u=t.target,f=t.global,d=t.stat,h=t.proto,p=f?st:d?st[u]:(st[u]||{}).prototype,y=f?ut:ut[u]||(ut[u]={}),v=y.prototype;for(o in e)n=!lt(f?o:u+(d?".":"#")+o,t.forced)&&p&&ht(p,o),c=y[o],n&&(s=t.noTargetGet?(l=at(p,o))&&l.value:p[o]),i=n&&s?s:e[o],n&&typeof c==typeof i||(a=t.bind&&n?ft(i,st):t.wrap&&n?pt(i):h&&"function"==typeof i?ft(Function.call,i):i,(t.sham||i&&i.sham||c&&c.sham)&&dt(a,"sham",!0),y[o]=a,h&&(ht(ut,r=u+"Prototype")||dt(ut,r,{}),ut[r][o]=i,t.real&&v&&!v[o]&&dt(v,o,i)))},vt=d,gt=Array.isArray||function(t){return"Array"==vt(t)};yt({target:"Array",stat:!0},{isArray:gt});var mt=V.Array.isArray,xt=mt,bt=xt;var St=function(t){if(bt(t))return t},wt={},Ot=n,Ct=ct,Tt=function(t,e){try{Ct(Ot,t,e)}catch(n){Ot[t]=e}return e},Et="__core-js_shared__",At=n[Et]||Tt(Et,{}),Rt=At,kt=Function.toString;"function"!=typeof Rt.inspectSource&&(Rt.inspectSource=function(t){return kt.call(t)});var Nt=Rt.inspectSource,Pt=n.WeakMap,jt="function"==typeof Pt&&/native code/.test(Nt(Pt)),Lt={exports:{}},Mt=At;(Lt.exports=function(t,e){return Mt[t]||(Mt[t]=void 0!==e?e:{})})("versions",[]).push({version:"3.6.4",mode:"pure",copyright:"© 2020 Denis Pushkarev (zloirock.ru)"});var It,Dt,_t,Ft=0,zt=Math.random(),Bt=function(t){return"Symbol("+String(void 0===t?"":t)+")_"+(++Ft+zt).toString(36)},Wt=Lt.exports,Gt=Bt,Ht=Wt("keys"),Kt=function(t){return Ht[t]||(Ht[t]=Gt(t))},Yt={},Ut=jt,Vt=b,Xt=ct,$t=C,Jt=Kt,qt=Yt,Qt=n.WeakMap;if(Ut){var Zt=new Qt,te=Zt.get,ee=Zt.has,ne=Zt.set;It=function(t,e){return ne.call(Zt,t,e),e},Dt=function(t){return te.call(Zt,t)||{}},_t=function(t){return ee.call(Zt,t)}}else{var re=Jt("state");qt[re]=!0,It=function(t,e){return Xt(t,re,e),e},Dt=function(t){return $t(t,re)?t[re]:{}},_t=function(t){return $t(t,re)}}var oe={set:It,get:Dt,has:_t,enforce:function(t){return _t(t)?Dt(t):It(t,{})},getterFor:function(t){return function(e){var n;if(!Vt(e)||(n=Dt(e)).type!==t)throw TypeError("Incompatible receiver, "+t+" required");return n}}},ie=v,ce=function(t){return Object(ie(t))},se=!o((function(){function t(){}return t.prototype.constructor=null,Object.getPrototypeOf(new t)!==t.prototype})),ae=C,le=ce,ue=se,fe=Kt("IE_PROTO"),de=Object.prototype,he=ue?Object.getPrototypeOf:function(t){return t=le(t),ae(t,fe)?t[fe]:"function"==typeof t.constructor&&t instanceof t.constructor?t.constructor.prototype:t instanceof Object?de:null},pe=o,ye=!!Object.getOwnPropertySymbols&&!pe((function(){return!String(Symbol())})),ve=ye&&!Symbol.sham&&"symbol"==typeof Symbol.iterator,ge=n,me=Lt.exports,xe=C,be=Bt,Se=ye,we=ve,Oe=me("wks"),Ce=ge.Symbol,Te=we?Ce:Ce&&Ce.withoutSetter||be,Ee=function(t){return xe(Oe,t)||(Se&&xe(Ce,t)?Oe[t]=Ce[t]:Oe[t]=Te("Symbol."+t)),Oe[t]},Ae=he;Ee("iterator");var Re,ke,Ne,Pe=!1;[].keys&&("next"in(Ne=[].keys())?(ke=Ae(Ae(Ne)))!==Object.prototype&&(Re=ke):Pe=!0),null==Re&&(Re={});var je,Le={IteratorPrototype:Re,BUGGY_SAFARI_ITERATORS:Pe},Me=Math.ceil,Ie=Math.floor,De=function(t){return isNaN(t=+t)?0:(t>0?Ie:Me)(t)},_e=De,Fe=Math.min,ze=function(t){return t>0?Fe(_e(t),9007199254740991):0},Be=De,We=Math.max,Ge=Math.min,He=function(t,e){var n=Be(t);return n<0?We(n+e,0):Ge(n,e)},Ke=x,Ye=ze,Ue=He,Ve=function(t){return function(e,n,r){var o,i=Ke(e),c=Ye(i.length),s=Ue(r,c);if(t&&n!=n){for(;c>s;)if((o=i[s++])!=o)return!0}else for(;c>s;s++)if((t||s in i)&&i[s]===n)return t||s||0;return!t&&-1}},Xe={includes:Ve(!0),indexOf:Ve(!1)},$e=C,Je=x,qe=Xe.indexOf,Qe=Yt,Ze=function(t,e){var n,r=Je(t),o=0,i=[];for(n in r)!$e(Qe,n)&&$e(r,n)&&i.push(n);for(;e.length>o;)$e(r,n=e[o++])&&(~qe(i,n)||i.push(n));return i},tn=["constructor","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","toLocaleString","toString","valueOf"],en=Ze,nn=tn,rn=Object.keys||function(t){return en(t,nn)},on=J,cn=Q,sn=rn,an=i?Object.defineProperties:function(t,e){cn(t);for(var n,r=sn(e),o=r.length,i=0;o>i;)on.f(t,n=r[i++],e[n]);return t},ln=V,un=n,fn=function(t){return"function"==typeof t?t:void 0},dn=function(t,e){return arguments.length<2?fn(ln[t])||fn(un[t]):ln[t]&&ln[t][e]||un[t]&&un[t][e]},hn=dn("document","documentElement"),pn=Q,yn=an,vn=tn,gn=Yt,mn=hn,xn=R,bn=Kt("IE_PROTO"),Sn=function(){},wn=function(t){return"<script>"+t+"</"+"script>"},On=function(){try{je=document.domain&&new ActiveXObject("htmlfile")}catch(t){}var t,e;On=je?function(t){t.write(wn("")),t.close();var e=t.parentWindow.Object;return t=null,e}(je):((e=xn("iframe")).style.display="none",mn.appendChild(e),e.src=String("javascript:"),(t=e.contentWindow.document).open(),t.write(wn("document.F=Object")),t.close(),t.F);for(var n=vn.length;n--;)delete On.prototype[vn[n]];return On()};gn[bn]=!0;var Cn=Object.create||function(t,e){var n;return null!==t?(Sn.prototype=pn(t),n=new Sn,Sn.prototype=null,n[bn]=t):n=On(),void 0===e?n:yn(n,e)},Tn={};Tn[Ee("toStringTag")]="z";var En="[object z]"===String(Tn),An=En,Rn=d,kn=Ee("toStringTag"),Nn="Arguments"==Rn(function(){return arguments}()),Pn=An?Rn:function(t){var e,n,r;return void 0===t?"Undefined":null===t?"Null":"string"==typeof(n=function(t,e){try{return t[e]}catch(t){}}(e=Object(t),kn))?n:Nn?Rn(e):"Object"==(r=Rn(e))&&"function"==typeof e.callee?"Arguments":r},jn=Pn,Ln=En?{}.toString:function(){return"[object "+jn(this)+"]"},Mn=En,In=J.f,Dn=ct,_n=C,Fn=Ln,zn=Ee("toStringTag"),Bn=function(t,e,n,r){if(t){var o=n?t:t.prototype;_n(o,zn)||In(o,zn,{configurable:!0,value:e}),r&&!Mn&&Dn(o,"toString",Fn)}},Wn=Le.IteratorPrototype,Gn=Cn,Hn=u,Kn=Bn,Yn=wt,Un=function(){return this};Object.setPrototypeOf||"__proto__"in{}&&function(){var t,e=!1,n={};try{(t=Object.getOwnPropertyDescriptor(Object.prototype,"__proto__").set).call(n,[]),e=n instanceof Array}catch(t){}}();var Vn=ct,Xn=function(t,e,n,r){r&&r.enumerable?t[e]=n:Vn(t,e,n)},$n=yt,Jn=function(t,e,n){var r=e+" Iterator";return t.prototype=Gn(Wn,{next:Hn(1,n)}),Kn(t,r,!1,!0),Yn[r]=Un,t},qn=he,Qn=Bn,Zn=ct,tr=Xn,er=wt,nr=Le.IteratorPrototype,rr=Le.BUGGY_SAFARI_ITERATORS,or=Ee("iterator"),ir="keys",cr="values",sr="entries",ar=function(){return this},lr=function(t,e,n,r,o,i,c){Jn(n,e,r);var s,a,l,u=function(t){if(t===o&&y)return y;if(!rr&&t in h)return h[t];switch(t){case ir:case cr:case sr:return function(){return new n(this,t)}}return function(){return new n(this)}},f=e+" Iterator",d=!1,h=t.prototype,p=h[or]||h["@@iterator"]||o&&h[o],y=!rr&&p||u(o),v="Array"==e&&h.entries||p;if(v&&(s=qn(v.call(new t)),nr!==Object.prototype&&s.next&&(Qn(s,f,!0,!0),er[f]=ar)),o==cr&&p&&p.name!==cr&&(d=!0,y=function(){return p.call(this)}),c&&h[or]!==y&&Zn(h,or,y),er[e]=y,o)if(a={values:u(cr),keys:i?y:u(ir),entries:u(sr)},c)for(l in a)(rr||d||!(l in h))&&tr(h,l,a[l]);else $n({target:e,proto:!0,forced:rr||d},a);return a},ur=x,fr=wt,dr=oe,hr=lr,pr="Array Iterator",yr=dr.set,vr=dr.getterFor(pr);hr(Array,"Array",(function(t,e){yr(this,{type:pr,target:ur(t),index:0,kind:e})}),(function(){var t=vr(this),e=t.target,n=t.kind,r=t.index++;return!e||r>=e.length?(t.target=void 0,{value:void 0,done:!0}):"keys"==n?{value:r,done:!1}:"values"==n?{value:e[r],done:!1}:{value:[r,e[r]],done:!1}}),"values"),fr.Arguments=fr.Array;var gr={CSSRuleList:0,CSSStyleDeclaration:0,CSSValueList:0,ClientRectList:0,DOMRectList:0,DOMStringList:0,DOMTokenList:1,DataTransferItemList:0,FileList:0,HTMLAllCollection:0,HTMLCollection:0,HTMLFormElement:0,HTMLSelectElement:0,MediaList:0,MimeTypeArray:0,NamedNodeMap:0,NodeList:1,PaintRequestList:0,Plugin:0,PluginArray:0,SVGLengthList:0,SVGNumberList:0,SVGPathSegList:0,SVGPointList:0,SVGStringList:0,SVGTransformList:0,SourceBufferList:0,StyleSheetList:0,TextTrackCueList:0,TextTrackList:0,TouchList:0},mr=n,xr=Pn,br=ct,Sr=wt,wr=Ee("toStringTag");for(var Or in gr){var Cr=mr[Or],Tr=Cr&&Cr.prototype;Tr&&xr(Tr)!==wr&&br(Tr,wr,Or),Sr[Or]=Sr.Array}var Er=De,Ar=v,Rr=function(t){return function(e,n){var r,o,i=String(Ar(e)),c=Er(n),s=i.length;return c<0||c>=s?t?"":void 0:(r=i.charCodeAt(c))<55296||r>56319||c+1===s||(o=i.charCodeAt(c+1))<56320||o>57343?t?i.charAt(c):r:t?i.slice(c,c+2):o-56320+(r-55296<<10)+65536}},kr={codeAt:Rr(!1),charAt:Rr(!0)}.charAt,Nr=oe,Pr=lr,jr="String Iterator",Lr=Nr.set,Mr=Nr.getterFor(jr);Pr(String,"String",(function(t){Lr(this,{type:jr,string:String(t),index:0})}),(function(){var t,e=Mr(this),n=e.string,r=e.index;return r>=n.length?{value:void 0,done:!0}:(t=kr(n,r),e.index+=t.length,{value:t,done:!1})}));var Ir,Dr,_r=Pn,Fr=wt,zr=Ee("iterator"),Br=function(t){if(null!=t)return t[zr]||t["@@iterator"]||Fr[_r(t)]},Wr=Q,Gr=Br,Hr=function(t){var e=Gr(t);if("function"!=typeof e)throw TypeError(String(t)+" is not iterable");return Wr(e.call(t))},Kr=Pn,Yr=wt,Ur=Ee("iterator"),Vr=function(t){var e=Object(t);return void 0!==e[Ur]||"@@iterator"in e||Yr.hasOwnProperty(Kr(e))},Xr=w,$r=J,Jr=u,qr=function(t,e,n){var r=Xr(e);r in t?$r.f(t,r,Jr(0,n)):t[r]=n},Qr=b,Zr=gt,to=Ee("species"),eo=function(t,e){var n;return Zr(t)&&("function"!=typeof(n=t.constructor)||n!==Array&&!Zr(n.prototype)?Qr(n)&&null===(n=n[to])&&(n=void 0):n=void 0),new(void 0===n?Array:n)(0===e?0:e)},no=dn("navigator","userAgent")||"",ro=no,oo=n.process,io=oo&&oo.versions,co=io&&io.v8;co?Dr=(Ir=co.split("."))[0]+Ir[1]:ro&&(!(Ir=ro.match(/Edge\/(\d+)/))||Ir[1]>=74)&&(Ir=ro.match(/Chrome\/(\d+)/))&&(Dr=Ir[1]);var so=Dr&&+Dr,ao=o,lo=so,uo=Ee("species"),fo=function(t){return lo>=51||!ao((function(){var e=[];return(e.constructor={})[uo]=function(){return{foo:1}},1!==e[t](Boolean).foo}))},ho=yt,po=o,yo=gt,vo=b,go=ce,mo=ze,xo=qr,bo=eo,So=fo,wo=so,Oo=Ee("isConcatSpreadable"),Co=9007199254740991,To="Maximum allowed index exceeded",Eo=wo>=51||!po((function(){var t=[];return t[Oo]=!1,t.concat()[0]!==t})),Ao=So("concat"),Ro=function(t){if(!vo(t))return!1;var e=t[Oo];return void 0!==e?!!e:yo(t)};ho({target:"Array",proto:!0,forced:!Eo||!Ao},{concat:function(t){var e,n,r,o,i,c=go(this),s=bo(c,0),a=0;for(e=-1,r=arguments.length;e<r;e++)if(Ro(i=-1===e?c:arguments[e])){if(a+(o=mo(i.length))>Co)throw TypeError(To);for(n=0;n<o;n++,a++)n in i&&xo(s,a,i[n])}else{if(a>=Co)throw TypeError(To);xo(s,a++,i)}return s.length=a,s}});var ko={},No=Ze,Po=tn.concat("length","prototype");ko.f=Object.getOwnPropertyNames||function(t){return No(t,Po)};var jo={},Lo=x,Mo=ko.f,Io={}.toString,Do="object"==typeof window&&window&&Object.getOwnPropertyNames?Object.getOwnPropertyNames(window):[];jo.f=function(t){return Do&&"[object Window]"==Io.call(t)?function(t){try{return Mo(t)}catch(t){return Do.slice()}}(t):Mo(Lo(t))};var _o={};_o.f=Object.getOwnPropertySymbols;var Fo={},zo=Ee;Fo.f=zo;var Bo=V,Wo=C,Go=Fo,Ho=J.f,Ko=function(t){var e=Bo.Symbol||(Bo.Symbol={});Wo(e,t)||Ho(e,t,{value:Go.f(t)})},Yo=$,Uo=y,Vo=ce,Xo=ze,$o=eo,Jo=[].push,qo=function(t){var e=1==t,n=2==t,r=3==t,o=4==t,i=6==t,c=5==t||i;return function(s,a,l,u){for(var f,d,h=Vo(s),p=Uo(h),y=Yo(a,l,3),v=Xo(p.length),g=0,m=u||$o,x=e?m(s,v):n?m(s,0):void 0;v>g;g++)if((c||g in p)&&(d=y(f=p[g],g,h),t))if(e)x[g]=d;else if(d)switch(t){case 3:return!0;case 5:return f;case 6:return g;case 2:Jo.call(x,f)}else if(o)return!1;return i?-1:r||o?o:x}},Qo={forEach:qo(0),map:qo(1),filter:qo(2),some:qo(3),every:qo(4),find:qo(5),findIndex:qo(6)},Zo=yt,ti=n,ei=dn,ni=i,ri=ye,oi=ve,ii=o,ci=C,si=gt,ai=b,li=Q,ui=ce,fi=x,di=w,hi=u,pi=Cn,yi=rn,vi=ko,gi=jo,mi=_o,xi=r,bi=J,Si=c,wi=ct,Oi=Xn,Ci=Lt.exports,Ti=Yt,Ei=Bt,Ai=Ee,Ri=Fo,ki=Ko,Ni=Bn,Pi=oe,ji=Qo.forEach,Li=Kt("hidden"),Mi="Symbol",Ii=Ai("toPrimitive"),Di=Pi.set,_i=Pi.getterFor(Mi),Fi=Object.prototype,zi=ti.Symbol,Bi=ei("JSON","stringify"),Wi=xi.f,Gi=bi.f,Hi=gi.f,Ki=Si.f,Yi=Ci("symbols"),Ui=Ci("op-symbols"),Vi=Ci("string-to-symbol-registry"),Xi=Ci("symbol-to-string-registry"),$i=Ci("wks"),Ji=ti.QObject,qi=!Ji||!Ji.prototype||!Ji.prototype.findChild,Qi=ni&&ii((function(){return 7!=pi(Gi({},"a",{get:function(){return Gi(this,"a",{value:7}).a}})).a}))?function(t,e,n){var r=Wi(Fi,e);r&&delete Fi[e],Gi(t,e,n),r&&t!==Fi&&Gi(Fi,e,r)}:Gi,Zi=function(t,e){var n=Yi[t]=pi(zi.prototype);return Di(n,{type:Mi,tag:t,description:e}),ni||(n.description=e),n},tc=oi?function(t){return"symbol"==typeof t}:function(t){return Object(t)instanceof zi},ec=function(t,e,n){t===Fi&&ec(Ui,e,n),li(t);var r=di(e,!0);return li(n),ci(Yi,r)?(n.enumerable?(ci(t,Li)&&t[Li][r]&&(t[Li][r]=!1),n=pi(n,{enumerable:hi(0,!1)})):(ci(t,Li)||Gi(t,Li,hi(1,{})),t[Li][r]=!0),Qi(t,r,n)):Gi(t,r,n)},nc=function(t,e){li(t);var n=fi(e),r=yi(n).concat(cc(n));return ji(r,(function(e){ni&&!rc.call(n,e)||ec(t,e,n[e])})),t},rc=function(t){var e=di(t,!0),n=Ki.call(this,e);return!(this===Fi&&ci(Yi,e)&&!ci(Ui,e))&&(!(n||!ci(this,e)||!ci(Yi,e)||ci(this,Li)&&this[Li][e])||n)},oc=function(t,e){var n=fi(t),r=di(e,!0);if(n!==Fi||!ci(Yi,r)||ci(Ui,r)){var o=Wi(n,r);return!o||!ci(Yi,r)||ci(n,Li)&&n[Li][r]||(o.enumerable=!0),o}},ic=function(t){var e=Hi(fi(t)),n=[];return ji(e,(function(t){ci(Yi,t)||ci(Ti,t)||n.push(t)})),n},cc=function(t){var e=t===Fi,n=Hi(e?Ui:fi(t)),r=[];return ji(n,(function(t){!ci(Yi,t)||e&&!ci(Fi,t)||r.push(Yi[t])})),r};if(ri||(zi=function(){if(this instanceof zi)throw TypeError("Symbol is not a constructor");var t=arguments.length&&void 0!==arguments[0]?String(arguments[0]):void 0,e=Ei(t),n=function(t){this===Fi&&n.call(Ui,t),ci(this,Li)&&ci(this[Li],e)&&(this[Li][e]=!1),Qi(this,e,hi(1,t))};return ni&&qi&&Qi(Fi,e,{configurable:!0,set:n}),Zi(e,t)},Oi(zi.prototype,"toString",(function(){return _i(this).tag})),Oi(zi,"withoutSetter",(function(t){return Zi(Ei(t),t)})),Si.f=rc,bi.f=ec,xi.f=oc,vi.f=gi.f=ic,mi.f=cc,Ri.f=function(t){return Zi(Ai(t),t)},ni&&Gi(zi.prototype,"description",{configurable:!0,get:function(){return _i(this).description}})),Zo({global:!0,wrap:!0,forced:!ri,sham:!ri},{Symbol:zi}),ji(yi($i),(function(t){ki(t)})),Zo({target:Mi,stat:!0,forced:!ri},{for:function(t){var e=String(t);if(ci(Vi,e))return Vi[e];var n=zi(e);return Vi[e]=n,Xi[n]=e,n},keyFor:function(t){if(!tc(t))throw TypeError(t+" is not a symbol");if(ci(Xi,t))return Xi[t]},useSetter:function(){qi=!0},useSimple:function(){qi=!1}}),Zo({target:"Object",stat:!0,forced:!ri,sham:!ni},{create:function(t,e){return void 0===e?pi(t):nc(pi(t),e)},defineProperty:ec,defineProperties:nc,getOwnPropertyDescriptor:oc}),Zo({target:"Object",stat:!0,forced:!ri},{getOwnPropertyNames:ic,getOwnPropertySymbols:cc}),Zo({target:"Object",stat:!0,forced:ii((function(){mi.f(1)}))},{getOwnPropertySymbols:function(t){return mi.f(ui(t))}}),Bi){var sc=!ri||ii((function(){var t=zi();return"[null]"!=Bi([t])||"{}"!=Bi({a:t})||"{}"!=Bi(Object(t))}));Zo({target:"JSON",stat:!0,forced:sc},{stringify:function(t,e,n){for(var r,o=[t],i=1;arguments.length>i;)o.push(arguments[i++]);if(r=e,(ai(e)||void 0!==t)&&!tc(t))return si(e)||(e=function(t,e){if("function"==typeof r&&(e=r.call(this,t,e)),!tc(e))return e}),o[1]=e,Bi.apply(null,o)}})}zi.prototype[Ii]||wi(zi.prototype,Ii,zi.prototype.valueOf),Ni(zi,Mi),Ti[Li]=!0,Ko("asyncIterator"),Ko("hasInstance"),Ko("isConcatSpreadable"),Ko("iterator"),Ko("match"),Ko("matchAll"),Ko("replace"),Ko("search"),Ko("species"),Ko("split"),Ko("toPrimitive"),Ko("toStringTag"),Ko("unscopables"),Bn(Math,"Math",!0),Bn(n.JSON,"JSON",!0);var ac=V.Symbol;Ko("asyncDispose"),Ko("dispose"),Ko("observable"),Ko("patternMatch"),Ko("replaceAll");var lc=ac,uc=Hr,fc=Vr,dc=lc;var hc=function(t,e){if(void 0!==dc&&fc(Object(t))){var n=[],r=!0,o=!1,i=void 0;try{for(var c,s=uc(t);!(r=(c=s.next()).done)&&(n.push(c.value),!e||n.length!==e);r=!0);}catch(t){o=!0,i=t}finally{try{r||null==s.return||s.return()}finally{if(o)throw i}}return n}},pc=Q,yc=wt,vc=Ee("iterator"),gc=Array.prototype,mc=$,xc=ce,bc=function(t,e,n,r){try{return r?e(pc(n)[0],n[1]):e(n)}catch(e){var o=t.return;throw void 0!==o&&pc(o.call(t)),e}},Sc=function(t){return void 0!==t&&(yc.Array===t||gc[vc]===t)},wc=ze,Oc=qr,Cc=Br,Tc=Ee("iterator"),Ec=!1;try{var Ac=0,Rc={next:function(){return{done:!!Ac++}},return:function(){Ec=!0}};Rc[Tc]=function(){return this},Array.from(Rc,(function(){throw 2}))}catch(t){}var kc=function(t){var e,n,r,o,i,c,s=xc(t),a="function"==typeof this?this:Array,l=arguments.length,u=l>1?arguments[1]:void 0,f=void 0!==u,d=Cc(s),h=0;if(f&&(u=mc(u,l>2?arguments[2]:void 0,2)),null==d||a==Array&&Sc(d))for(n=new a(e=wc(s.length));e>h;h++)c=f?u(s[h],h):s[h],Oc(n,h,c);else for(i=(o=d.call(s)).next,n=new a;!(r=i.call(o)).done;h++)c=f?bc(o,u,[r.value,h],!0):r.value,Oc(n,h,c);return n.length=h,n};yt({target:"Array",stat:!0,forced:!function(t,e){if(!e&&!Ec)return!1;var n=!1;try{var r={};r[Tc]=function(){return{next:function(){return{done:n=!0}}}},t(r)}catch(t){}return n}((function(t){Array.from(t)}))},{from:kc});var Nc=V.Array.from,Pc=i,jc=o,Lc=C,Mc=Object.defineProperty,Ic={},Dc=function(t){throw t},_c=function(t,e){if(Lc(Ic,t))return Ic[t];e||(e={});var n=[][t],r=!!Lc(e,"ACCESSORS")&&e.ACCESSORS,o=Lc(e,0)?e[0]:Dc,i=Lc(e,1)?e[1]:void 0;return Ic[t]=!!n&&!jc((function(){if(r&&!Pc)return!0;var t={length:-1};r?Mc(t,1,{enumerable:!0,get:Dc}):t[1]=1,n.call(t,o,i)}))},Fc=yt,zc=b,Bc=gt,Wc=He,Gc=ze,Hc=x,Kc=qr,Yc=Ee,Uc=_c,Vc=fo("slice"),Xc=Uc("slice",{ACCESSORS:!0,0:0,1:2}),$c=Yc("species"),Jc=[].slice,qc=Math.max;Fc({target:"Array",proto:!0,forced:!Vc||!Xc},{slice:function(t,e){var n,r,o,i=Hc(this),c=Gc(i.length),s=Wc(t,c),a=Wc(void 0===e?c:e,c);if(Bc(i)&&("function"!=typeof(n=i.constructor)||n!==Array&&!Bc(n.prototype)?zc(n)&&null===(n=n[$c])&&(n=void 0):n=void 0,n===Array||void 0===n))return Jc.call(i,s,a);for(r=new(void 0===n?Array:n)(qc(a-s,0)),o=0;s<a;s++,o++)s in i&&Kc(r,o,i[s]);return r.length=o,r}});var Qc=V,Zc=function(t){return Qc[t+"Prototype"]},ts=Zc("Array").slice,es=Array.prototype,ns=function(t){var e=t.slice;return t===es||t instanceof Array&&e===es.slice?ts:e};var rs=function(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r},os=Nc,is=ns,cs=rs;var ss=function(t,e){var n;if(t){if("string"==typeof t)return cs(t,e);var r=is(n=Object.prototype.toString.call(t)).call(n,8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?os(r):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?cs(t,e):void 0}};var as=St,ls=hc,us=ss,fs=function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")};var ds=function(t,e){return as(t)||ls(t,e)||us(t,e)||fs()},hs=n,ps=[].slice,ys=function(t){return function(e,n){var r=arguments.length>2,o=r?ps.call(arguments,2):void 0;return t(r?function(){("function"==typeof e?e:Function(e)).apply(this,o)}:e,n)}};yt({global:!0,bind:!0,forced:/MSIE .\./.test(no)},{setTimeout:ys(hs.setTimeout),setInterval:ys(hs.setInterval)});var vs=V.setTimeout,gs=o,ms=function(t,e){var n=[][t];return!!n&&gs((function(){n.call(null,e||function(){throw 1},1)}))},xs=yt,bs=Xe.indexOf,Ss=ms,ws=_c,Os=[].indexOf,Cs=!!Os&&1/[1].indexOf(1,-0)<0,Ts=Ss("indexOf"),Es=ws("indexOf",{ACCESSORS:!0,1:0});xs({target:"Array",proto:!0,forced:Cs||!Ts||!Es},{indexOf:function(t){return Cs?Os.apply(this,arguments)||0:bs(this,t,arguments.length>1?arguments[1]:void 0)}});var As=Zc("Array").indexOf,Rs=Array.prototype,ks=function(t){var e=t.indexOf;return t===Rs||t instanceof Array&&e===Rs.indexOf?As:e};yt({target:"Date",stat:!0},{now:function(){return(new Date).getTime()}});var Ns=V.Date.now;var Ps=function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")},js={exports:{}};yt({target:"Object",stat:!0,forced:!i,sham:!i},{defineProperty:J.f});var Ls=V.Object,Ms=js.exports=function(t,e,n){return Ls.defineProperty(t,e,n)};Ls.defineProperty.sham&&(Ms.sham=!0);var Is=js.exports,Ds=Is;function _s(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Ds(t,r.key,r)}}var Fs=function(t,e,n){return e&&_s(t.prototype,e),n&&_s(t,n),t},zs=Is;var Bs=function(t,e,n){return e in t?zs(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t},Ws=function(){function t(e,n){Ps(this,t),this.node=e,this.offset=n}return Fs(t,null,[{key:"getSelectText",value:function(t,e,n,r){var o="";if(t.childNodes.length&&"SCRIPT"!==t.nodeName&&"STYLE"!==t.nodeName){var i=t.childNodes[0];return o+=this.getSelectText(i,e,0,r)}if("#text"===t.nodeName){var c=t===e?r:t.textContent.length;o+=t.textContent.substring(n,c)}if(t===e)return o;var s=t.nextSibling;if(s){o+=this.getSelectText(s,e,0,r)}else{for(var a=t.parentNode;a&&null===a.nextSibling;)a=a.parentNode;if(!a)throw new Error("Invalid end node");o+=this.getSelectText(a.nextSibling,e,0,r)}return o}}]),t}(),Gs=xt,Hs=rs;var Ks=Nc,Ys=Vr,Us=lc;var Vs=function(t){if(Gs(t))return Hs(t)},Xs=function(t){if(void 0!==Us&&Ys(Object(t)))return Ks(t)},$s=ss,Js=function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")};var qs=function(t){return Vs(t)||Xs(t)||$s(t)||Js()},Qs=ns,Zs=gt,ta=[].reverse,ea=[1,2];yt({target:"Array",proto:!0,forced:String(ea)===String(ea.reverse())},{reverse:function(){return Zs(this)&&(this.length=this.length),ta.call(this)}});var na=Zc("Array").reverse,ra=Array.prototype,oa=function(t){var e=t.reverse;return t===ra||t instanceof Array&&e===ra.reverse?na:e},ia=Qo.forEach,ca=_c,sa=ms("forEach"),aa=ca("forEach"),la=sa&&aa?[].forEach:function(t){return ia(this,t,arguments.length>1?arguments[1]:void 0)};yt({target:"Array",proto:!0,forced:[].forEach!=la},{forEach:la});var ua=Zc("Array").forEach,fa=Pn,da=Array.prototype,ha={DOMTokenList:!0,NodeList:!0},pa=function(t){var e=t.forEach;return t===da||t instanceof Array&&e===da.forEach||ha.hasOwnProperty(fa(t))?ua:e},ya=yt,va=Qo.map,ga=_c,ma=fo("map"),xa=ga("map");ya({target:"Array",proto:!0,forced:!ma||!xa},{map:function(t){return va(this,t,arguments.length>1?arguments[1]:void 0)}});var ba=Zc("Array").map,Sa=Array.prototype,wa=function(t){var e=t.map;return t===Sa||t instanceof Array&&e===Sa.map?ba:e},Oa=mt,Ca=function(){function t(e){var n=this,r=e.container,o=e.rectsColor,i=void 0===o?"rgba(23,136,189,0.35)":o;Ps(this,t),Bs(this,"setRects",(function(t,e,r){var o;n.reset(),o=Oa(t)?t:[t];var i=document.createDocumentFragment();n.elements=wa(o).call(o,(function(t){var o=document.createElement("div");return o.classList.add("mobile-text-selection-tools","mobile-text-selection-tools-rect"),o.style.pointerEvents="none",o.style.width="".concat(t.width,"px"),o.style.height="".concat(t.height,"px"),o.style.backgroundColor=n.rectsColor,o.style.position="absolute",o.style.left="".concat(t.left-e,"px"),o.style.top="".concat(t.top-r,"px"),i.appendChild(o),o})),n.container.appendChild(i)})),Bs(this,"reset",(function(){var t,e,r;pa(t=oa(e=Qs(r=n.elements).call(r)).call(e)).call(t,(function(t){return n.container.removeChild(t)})),n.elements=[]})),this.container=r,this.rectsColor=i,this.elements=[]}return Fs(t,[{key:"getSelectRects",value:function(t,e,n,r){var o=[];if(t.childNodes.length&&"SCRIPT"!==t.nodeName&&"STYLE"!==t.nodeName){var i=t.childNodes[0],c=this.getSelectRects(i,e,0,r);return o.push.apply(o,qs(c)),o}if("#text"===t.nodeName){var s=t===e?r:t.textContent.length,a=document.createRange();a.setStart(t,n),a.setEnd(t,s),o.push.apply(o,qs(a.getClientRects()))}if(t===e)return o;var l=t.nextSibling;if(l){var u=this.getSelectRects(l,e,0,r);o.push.apply(o,qs(u))}else{var f=t.parentNode;if(f===this.container)return[];for(;f&&(null===f.nextSibling||f===this.container);)f=f.parentNode;if(f&&f===this.container)return[];if(!f)throw new Error("Invalid end node");var d=this.getSelectRects(f.nextSibling,e,0,r);o.push.apply(o,qs(d))}return o}}]),t}(),Ta=Zc("Array").concat,Ea=Array.prototype,Aa=function(t){var e=t.concat;return t===Ea||t instanceof Array&&e===Ea.concat?Ta:e},Ra=function(){function t(e){var n=this,r=e.container,o=e.cursorDom,i=e.type,c=e.color,s=void 0===c?"#1788bd":c;Ps(this,t),Bs(this,"createElement",(function(){var t,e=document.createElement("div");if(e.classList.add("mobile-text-selection-tools","mobile-text-selection-tools-cursor"),e.style.userSelect="none",e.style.webkitUserSelect="none",e.style.display="none",e.style.position="absolute",e.style.left="0px",e.style.top="0px",e.style.zIndex=2,e.style.width="".concat(2*n.size,"px"),"start"===n.type&&(e.style.transform="scaleX(-1)"),n.cursorDom&&n.cursorDom instanceof Element)t=n.cursorDom.cloneNode(!0);else{var r;(t=document.createElement("div")).style.boxSizing="border-box",t.style.width="".concat(2*n.size,"px"),t.style.height="".concat(3*n.size,"px");var o=document.createElement("div");o.style.width="0",o.style.height="0",o.style.borderWidth="".concat(n.size/2,"px"),o.style.borderColor=Aa(r="transparent transparent ".concat(n.color," ")).call(r,n.color),o.style.borderStyle="solid";var i=document.createElement("div");i.style.width="".concat(n.size,"px"),i.style.height="".concat(n.size,"px"),i.style.backgroundColor=n.color,t.appendChild(o),t.appendChild(i)}return e.appendChild(t),e})),Bs(this,"show",(function(){n.element.style.display="block"})),Bs(this,"hide",(function(){n.element.style.display="none"})),this.container=r,this.element=null,this.cursorDom=o,this.type=i,this._position={x:0,y:0},this.height=0,this.size=15,this.color=s,this.element=this.createElement(),r.appendChild(this.element)}return Fs(t,[{key:"moveTo",value:function(t,e){"start"===this.type?this.element.style.left="".concat(t-2*this.size,"px"):this.element.style.left="".concat(t,"px"),this.element.style.top="".concat(e+this.height,"px")}},{key:"position",set:function(t){var e=t.x,n=t.y;this._position={x:e,y:n},this.moveTo(e,n)},get:function(){return this._position}}]),t}(),ka=function(){function t(e){var n=this,r=e.container,o=e.rectsColor,i=e.backgroundColor,c=e.height,s=void 0===c?50:c,a=e.width,l=void 0===a?100:a,u=e.offset,f=void 0===u?50:u;Ps(this,t),Bs(this,"moveTo",(function(t,e){var r,o,i,c=n.container.getBoundingClientRect().width,s=n.container.getBoundingClientRect().height;n.slip.style.clipPath=Aa(r=Aa(o=Aa(i="inset(\n        ".concat(e-n.height/2,"px\n        ")).call(i,c-t-n.width/2,"px\n        ")).call(o,s-e-n.height/2,"px\n        ")).call(r,t-n.width/2,"px\n    )"),n.clip.style.top="".concat(e-n.offset-n.height/2,"px"),n.clip.style.left="".concat(t-n.width/2,"px")})),Bs(this,"show",(function(){n.clip.style.display="block",n.slip.style.display="block"})),Bs(this,"hide",(function(){n.clip.style.display="none",n.slip.style.display="none"})),Bs(this,"createSlip",(function(){var t=n.container.cloneNode(!0);return t.classList.add("mobile-text-selection-tools","mobile-text-selection-tools-slip"),t.style.pointerEvents="none",t.style.position="absolute",t.style.marginTop=0,t.style.marginRight=0,t.style.marginBottom=0,t.style.marginLeft=0,t.style.top="".concat(-n.offset,"px"),t.style.left=0,t.style.backgroundColor=n.backgroundColor,t.style.display="none",t.style.zIndex="3",t})),Bs(this,"createClip",(function(){var t=document.createElement("div");return t.classList.add("mobile-text-selection-tools","mobile-text-selection-tools-clip"),t.style.pointerEvent="none",t.style.userSelect="none",t.style.webkitUserSelect="none",t.style.position="absolute",t.style.height="".concat(n.height,"px"),t.style.width="".concat(n.width,"px"),t.style.boxShadow="0px 1px 2px 1px #666, inset 0px 0px 2px 2px #fff",t.style.borderRadius="5px",t.style.display="none",t.style.zIndex="3",t})),this.container=r,this.height=s,this.width=l,this.offset=f,this.backgroundColor=i,this._position={x:0,y:0},this.slip=this.createSlip(),this.clip=this.createClip(),this.rect=null,r.appendChild(this.slip),r.appendChild(this.clip),this.rects=new Ca({container:this.slip,rectsColor:o})}return Fs(t,[{key:"position",set:function(t){var e=t.x,n=t.y;this._position={x:e,y:n},this.moveTo(e,n)}}]),t}(),Na=yt,Pa=Qo.find,ja="find",La=!0,Ma=_c(ja);ja in[]&&Array(1).find((function(){La=!1})),Na({target:"Array",proto:!0,forced:La||!Ma},{find:function(t){return Pa(this,t,arguments.length>1?arguments[1]:void 0)}});var Ia=Zc("Array").find,Da=Array.prototype,_a=function(t){var e=t.find;return t===Da||t instanceof Array&&e===Da.find?Ia:e},Fa=function(){function t(e){var n=this,r=e.container,o=e.backgroundColor,i=void 0===o?"#000000":o,c=e.color,s=void 0===c?"#ffffff":c,a=e.menu,l=void 0===a?[]:a;Ps(this,t),Bs(this,"moveTo",(function(t,e){n.show();var r=n.element.getBoundingClientRect().width,o=n.element.getBoundingClientRect().height;n.hide();var i=n.container.getBoundingClientRect(),c=t,s=e,a=document.documentElement.clientWidth||document.body.clientWidth;c=t+i.left<r/2+n.paddingLR?n.paddingLR-i.left:t+i.left>a-r/2-n.paddingLR?a-r-i.left-n.paddingLR:t-r/2;var l=1.5*Number(window.getComputedStyle(n.container).fontSize.replace("px",""));s=e+i.top<l+o?e+2.5*l:e-o-l,n.element.style.top="".concat(s,"px"),n.element.style.left="".concat(c,"px")})),Bs(this,"show",(function(){n.element.style.display="block"})),Bs(this,"hide",(function(){n.element.style.display="none"})),Bs(this,"createElement",(function(){var t,e=document.createElement("div");e.classList.add("mobile-text-selection-tools","mobile-text-selection-tools-menu"),e.style.userSelect="none",e.style.webkitUserSelect="none",e.style.display="none",e.style.position="absolute",e.style.left="0px",e.style.top="0px",e.style.zIndex="3",e.style.borderRadius="4px",e.style.overflow="hidden",e.style.boxShadow="0px 1px 2px 1px #666";var r=document.documentElement.clientWidth||document.body.clientWidth;e.style.maxWidth="".concat(r-2*n.paddingLR,"px");var o=document.createElement("div");o.style.overflow="scroll";var i=document.createElement("div");return i.style.display="flex",i.style.alignItems="center",i.style.width="max-content",wa(t=n.menu).call(t,(function(t){var e=document.createElement("div");if(e.style.display="flex",e.style.flex="1 0 auto",e.style.alignItems="center",e.style.padding="10px 15px",e.style.boxSizing="border-box",e.style.boxSizing="border-box",e.style.backgroundColor=n.backgroundColor,!t.key)throw new Error("菜单项需要参数key");if(e.dataset.key=t.key,t.icon){var r=document.createElement("div");r.style.display="flex",r.style.alignItems="center",r.style.justifyContent="center",r.style.marginRight="5px",r.style.maxWidth="1.2em",r.style.maxHeight="1.2em",r.appendChild(t.icon),e.appendChild(r);var o=r.querySelector("img");o&&(o.style.width="100%",o.style.height="100%")}if(t.text){var c=document.createElement("span");c.style.color=n.color,c.innerText=t.text,e.appendChild(c)}if(t.click){if("function"!=typeof t.click)throw Error("参数click类型错误");e.onclick=function(){return t.click(t.key)}}n.menuItemElements.push(e),i.appendChild(e)})),o.appendChild(i),e.appendChild(o),e})),this.container=r,this.backgroundColor=i,this.color=s,this.menu=l,this.paddingLR=10,this.element=null,this.menuItemElements=[],this._position={x:0,y:0},this.element=this.createElement(),r.appendChild(this.element)}return Fs(t,[{key:"getSelectMenuKey",value:function(t){var e,n=_a(e=this.menuItemElements).call(e,(function(e){return ks(t).call(t,e)>-1}));return n&&n.dataset.key}},{key:"clickMenuItem",value:function(t,e){var n,r=_a(n=this.menu).call(n,(function(e){return e.key===t}));r.click&&r.click(e)}},{key:"position",set:function(t){var e=t.x,n=t.y;this._position={x:e,y:n},this.moveTo(e,n)}}]),t}();function za(t){return t.path||t.composedPath&&t.composedPath()||""}function Ba(t,e,n){return e>=t-n/2&&e<=t+n/2}function Wa(t,e,n){var r=document.createRange();r.setStart(t,e),r.setEnd(t,n);var o=r.getClientRects();return o.length?o[0]:null}function Ga(t,e){var n=null,r=function(t,e){var n=Ha(t,e);if(n&&n!==e)return n;return null}(t,e);return r&&(n=Wa(r,0,1)),n}function Ha(t,e){var n=null;if(t.classList&&t.classList.contains("mobile-text-selection-tools"))return null;if(t.childNodes.length){var r=t.childNodes[0];n="#text"!==r.nodeName||/^\s+$/.test(r.textContent)?Ha(r,e):r}if(n)return n;for(var o=t.nextSibling;!n&&o;)(n="#text"!==o.nodeName||/^\s+$/.test(o.textContent)?Ha(o,e):o)||(o=o.nextSibling);if(n)return n;for(var i,c=t.parentNode;!i&&c!==e;)i=c.nextSibling,c=c.parentNode;for(;!n&&i;)"#text"!==i.nodeName||/^\s+$/.test(i.textContent)?(n=Ha(i,e))||(i=i.nextSibling):n=i;return n||(c===e?e:n)}return function(){function t(e){var n=this,r=e.container,o=e.cursorDom,i=e.cursorColor,c=e.rectsColor,s=e.magnifierHeight,a=e.magnifierWidth,l=e.magnifierOffset,u=e.magnifierBackgroundColor,f=e.longTapDuration,d=void 0===f?600:f,h=e.menu,p=e.menuBackgroundColor,y=e.menuColor,v=e.tokenizer,g=void 0===v?function(){}:v,m=e.onFinish,x=void 0===m?function(){}:m,b=e.onStart,S=void 0===b?function(){}:b,w=e.onCancel,O=void 0===w?function(){}:w;if(Ps(this,t),Bs(this,"blur",(function(){n.cursor.start.hide(),n.cursor.end.hide(),n.rects.reset(),n.selectStatus="none",n.magnifier.hide(),n.menu.hide(),n.onCancel()})),Bs(this,"init",(function(){n.container.oncontextmenu=function(t){t.preventDefault()},n.container.style.userSelect="none",n.container.style.webkitUserSelect="none",n.container.style.webkitTouchCallout="none",n.magnifier=new ka({container:n.container,rectsColor:n.rectsColor,backgroundColor:n.magnifierBackgroundColor,height:n.magnifierHeight,width:n.magnifierWidth,offset:n.magnifierOffset}),n.container.addEventListener("touchstart",n.handleTouchStart),n.container.addEventListener("touchmove",n.handleTouchMove),n.container.addEventListener("touchend",n.handleTouchEnd),n.container.style.position="relative",n.cursor.start=new Ra({container:n.container,cursorDom:n.cursorDom,type:"start",color:n.cursorColor}),n.cursor.end=new Ra({container:n.container,cursorDom:n.cursorDom,type:"end",color:n.cursorColor}),n.rects=new Ca({container:n.container,rectsColor:n.rectsColor}),n.menu=new Fa({container:n.container,menu:n.menu,backgroundColor:n.menuBackgroundColor,color:n.menuColor})})),Bs(this,"destroy",(function(){n.container.oncontextmenu=null,n.container.removeEventListener("touchstart",n.handleTouchStart),n.container.removeEventListener("touchmove",n.handleTouchMove),n.container.removeEventListener("touchend",n.handleTouchEnd);for(var t=n.container.getElementsByClassName("mobile-text-selection-tools"),e=t.length-1;e>=0;e--)t[e].remove();n.container._textSelection=null})),Bs(this,"handleTouchStart",(function(t){var e,r,o,i=t,c=t.changedTouches[0],s=c.clientX,a=c.clientY;n.touchStartTime=Ns(),n.touchStartPosition={x:s,y:a};var l=ks(e=za(i)).call(e,n.menu.element)>-1,u=ks(r=za(i)).call(r,n.cursor.start.element)>-1,f=ks(o=za(i)).call(o,n.cursor.end.element)>-1;l?(n.touchingMenuKey=n.menu.getSelectMenuKey(za(i)),i.stopPropagation()):(n.menu.hide(),u?(n.movingCursor=n.cursor.start,n.selectStatus="selecting",i.stopPropagation()):f?(n.movingCursor=n.cursor.end,n.selectStatus="selecting",i.stopPropagation()):n.longTapTimer=vs((function(){i.stopPropagation(),n.onStart(),i.target&&(n.magnifier.show(),n.handleLongTap(i.target,s,a)),n.selectStatus="selecting"}),n.longTapDuration))})),Bs(this,"handleTouchMove",(function(t){var e=t;if("selecting"===n.selectStatus){e.stopPropagation(),e.preventDefault();var r=e.changedTouches[0],o=r.clientX,i=r.clientY,c=n.container.getBoundingClientRect();if(i<c.top&&(i=c.top),i>c.bottom&&(i=c.bottom),o<c.left&&(o=c.left),o>c.right&&(o=c.right),n.movingCursor){n.onStart(),n.movingCursor.hide();var s=document.elementFromPoint(o,i);s&&s instanceof HTMLIFrameElement&&(s=s.contentWindow.document.elementFromPoint(o,i)),n.cursor.start.show(),n.cursor.end.show(),s&&(n.magnifier.show(),n.moveCursor(s,o,i))}else if(n.rects){var a=document.elementFromPoint(o,i);a&&a instanceof HTMLIFrameElement&&(a=a.contentWindow.document.elementFromPoint(o,i)),a&&(n.magnifier.show(),n.handleLongTap(a,o,i))}}else if(n.touchingMenuKey){var l=n.menu.getSelectMenuKey(za(e));l&&l===n.touchingMenuKey||(n.touchingMenuKey=null)}clearTimeout(n.longTapTimer),n.longTapTimer=null})),Bs(this,"handleTouchEnd",(function(t){var e=t;clearTimeout(n.longTapTimer),n.longTapTimer=null,n.movingCursor=null,n.magnifier.hide();var r=e.changedTouches[0];if(n.touchingMenuKey){var o=n.getText();n.menu.clickMenuItem(n.touchingMenuKey,{text:o}),n.touchingMenuKey=null,n.blur()}else if(Ns()-n.touchStartTime<n.longTapDuration&&r.clientX===n.touchStartPosition.x&&r.clientY===n.touchStartPosition.y)n.blur();else{e.stopPropagation();var i=n.getText();n.rects.elements.length&&i&&(n.menu.position={x:(n.cursor.start.position.x+n.cursor.end.position.x)/2,y:n.cursor.start.position.y},n.menu.show(),n.onFinish({text:i,startX:n.cursor.start.position.x,startY:n.cursor.start.position.y,endX:n.cursor.end.position.x,endY:n.cursor.end.position.y}),n.selectStatus="finished")}})),Bs(this,"getText",(function(){if(n.textNode.start&&n.textNode.end)return Ws.getSelectText(n.textNode.start.node,n.textNode.end.node,n.textNode.start.offset,n.textNode.end.offset)})),Bs(this,"moveCursor",(function(t,e,r){if(t&&!/^\s+$/.test(t)){var o=n.getMoveOrTapRectPosition(t,e,r)||{},i=o.x,c=o.y,s=o.node,a=o.index,l=o.height,u=i-n.screenRelativeOffset.x,f=c-n.screenRelativeOffset.y;if(s&&(u||f)){var d=n.movingCursor===n.cursor.start?n.cursor.end:n.cursor.start;if(d.position.x===u&&d.position.y===f)return n.cursor.start.hide(),n.cursor.end.hide(),void n.rects.reset();if(n.movingCursor===n.cursor.start){var h=n.cursor.end.position;if(!(function(t,e,n){return e<t-n/2}(h.y,f,l)||Ba(h.y,f,l)&&u<h.x))return n.cursor.start.position=n.cursor.end.position,n.movingCursor=n.cursor.end,n.textNode.start=new Ws(n.textNode.end.node,n.textNode.end.offset),void(n.textNode.end=new Ws(s,a));n.textNode.start=new Ws(s,a)}else{var p=n.cursor.start.position;if(!(function(t,e,n){return e>t+n/2}(p.y,f,l)||Ba(p.y,f,l)&&u>p.x))return n.cursor.end.position=n.cursor.start.position,n.movingCursor=n.cursor.start,n.textNode.end=new Ws(n.textNode.start.node,n.textNode.start.offset),void(n.textNode.start=new Ws(s,a));n.textNode.end=new Ws(s,a)}n.movingCursor.position={x:i-n.screenRelativeOffset.x,y:c-n.screenRelativeOffset.y},n.magnifier.position={x:i-n.screenRelativeOffset.x,y:c-n.screenRelativeOffset.y};var y=n.rects.getSelectRects(n.textNode.start.node,n.textNode.end.node,n.textNode.start.offset,n.textNode.end.offset);y.length&&(n.rects.setRects(y,n.screenRelativeOffset.x,n.screenRelativeOffset.y),n.magnifier.rects.setRects(y,n.screenRelativeOffset.x,n.screenRelativeOffset.y))}}})),Bs(this,"handleLongTap",(function(t,e,r){n.magnifier.position={x:e-n.screenRelativeOffset.x,y:r-n.screenRelativeOffset.y};var o=n.getMoveOrTapRectPosition(t,e,r)||{},i=o.node,c=o.rect,s=o.index,a=o.height;if(c&&(!c||0!==c.length)){var l=n.tokenizer&&n.tokenizer(i,s)||[-1,0],u=ds(l,2),f=u[0],d=u[1];if("number"==typeof f&&"number"==typeof d&&f>-1&&d>1){n.textNode.start=new Ws(i,f),n.textNode.end=new Ws(i,f+d);var h=n.rects.getSelectRects(n.textNode.start.node,n.textNode.end.node,n.textNode.start.offset,n.textNode.end.offset);h.length&&(n.rects.setRects(h,n.screenRelativeOffset.x,n.screenRelativeOffset.y),n.cursor.start.height=a,n.cursor.end.height=a,n.cursor.start.position={x:h[0].x-n.screenRelativeOffset.x,y:h[0].y-n.screenRelativeOffset.y},n.cursor.end.position={x:h[h.length-1].x+h[h.length-1].width-n.screenRelativeOffset.x,y:h[h.length-1].y-n.screenRelativeOffset.y},n.cursor.start.show(),n.cursor.end.show(),n.magnifier.rects.setRects(h,n.screenRelativeOffset.x,n.screenRelativeOffset.y))}else n.textNode.start=new Ws(i,s),n.textNode.end=new Ws(i,s+1),n.rects.setRects(c,n.screenRelativeOffset.x,n.screenRelativeOffset.y),n.cursor.start.height=a,n.cursor.end.height=a,n.cursor.start.position={x:c.x-n.screenRelativeOffset.x,y:c.y-n.screenRelativeOffset.y},n.cursor.end.position={x:c.x+c.width-n.screenRelativeOffset.x,y:c.y-n.screenRelativeOffset.y},n.cursor.start.show(),n.cursor.end.show(),n.magnifier.rects.setRects(c,n.screenRelativeOffset.x,n.screenRelativeOffset.y)}})),Bs(this,"getMoveOrTapRectPosition",(function(t,e,r){if(!n.container.contains(t))return null;if("#comment"===t.nodeName||t.classList.contains("mobile-text-selection-tools"))return null;if(!t||t&&!t.childNodes)return null;for(var o=Number(window.getComputedStyle(t).lineHeight.replace("px","")),i=0;i<t.childNodes.length;i++){var c=t.childNodes[i];if("#text"===c.nodeName){var s=c.textContent;window.getSelection().removeAllRanges();for(var a=0;a<s.length;a++){var l=Wa(c,a,a+1);if(l){var u=(o=o||l.height)/2;if(l.left<e&&l.top-u<r&&l.bottom+u>r){var f=null;if(f=a===s.length-1?Ga(c,n.container):Wa(c,a+1,a+2),l.right>e)return{x:l.left,y:l.top,node:c,index:a,height:l.height,width:l.width,rect:l};if(!f||f&&f.right<l.left)return{x:l.right,y:l.top,node:c,index:a+1,height:l.height,width:l.width,rect:l}}}}}else{if("#comment"===c.nodeName||c.classList.contains("mobile-text-selection-tools"))continue;var d=n.getMoveOrTapRectPosition(c,e,r);if(d)return d}}return null})),!r)throw Error("TextSelection 容器不能为空");if(g&&"function"!=typeof g)throw Error("参数tokenizer类型错误");if(x&&"function"!=typeof x)throw Error("参数onFinish类型错误");if(S&&"function"!=typeof S)throw Error("参数onStart类型错误");if(O&&"function"!=typeof O)throw Error("参数onCancel类型错误");r._textSelection&&r._textSelection.destroy(),this.container=r,this.longTapTimer=null,this.longTapDuration=d,this.touchStartPosition={x:0,y:0},this.touchStartTime=null,this.touchMoveDuration=0,this.cursorColor=i,this.cursorDom=o,this.cursor={start:null,end:null},this.textNode={start:null,end:null},this.movingCursor=null,this.touchingMenuKey=null,this.mask=null,this.selectStatus="none",this.tokenizer=g,this.onFinish=x,this.onStart=S,this.onCancel=O,this.rects=null,this.rectsColor=c,this.magnifier=null,this.magnifierHeight=s,this.magnifierWidth=a,this.magnifierOffset=l,this.magnifierBackgroundColor=u,this.menu=h,this.menuBackgroundColor=p,this.menuColor=y,r._textSelection=this}return Fs(t,[{key:"screenRelativeOffset",get:function(){var t=this.container.getBoundingClientRect(),e=t.top;return{x:t.left,y:e}}}]),t}()}));
